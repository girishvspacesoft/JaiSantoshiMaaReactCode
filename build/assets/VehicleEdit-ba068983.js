import{r as u,a as e}from"./react-bfabd40c.js";import{d as Q}from"./dayjs-7f45ce31.js";import{L as G,A as J,D as K}from"./x-date-pickers-7b1cc7dd.js";import"./Card.module-3bdbfb7f.js";import{ac as U,aj as X,ag as Z,ah as $,L as ee,ak as te}from"./index-4082e4b8.js";import{T as ae,a as ie}from"./TaxDetailList-9dbaaa6a.js";import{u as A,a as re}from"./react-redux-45d870ba.js";import{a as ne,b as le}from"./react-router-622b2d59.js";import{O as se,Q as oe,a as me,i as v,A as H,h as g,V as b,l as T}from"./material-e0a59a28.js";import"./@babel-e11bafe1.js";import"./@date-io-f382d426.js";import"./utils-c03c978f.js";import"./clsx-1229b3e0.js";import"./base-ff50cfe3.js";import"./@popperjs-f3391c26.js";import"./react-dom-b0178e93.js";import"./scheduler-765c72db.js";import"./rifm-7b0f12ad.js";import"./system-a1d29c52.js";import"./styled-engine-f3bd09bf.js";import"./@emotion-77835cc8.js";import"./hoist-non-react-statics-6cfbf744.js";import"./stylis-79144faa.js";import"./private-theming-970ac73c.js";import"./react-transition-group-7ded6f4d.js";import"./dom-helpers-9a525042.js";import"./redux-persist-d9cc1560.js";import"./redux-b7ba668d.js";import"./@reduxjs-4d37e7cf.js";import"./immer-41fd5235.js";import"./redux-thunk-ef899f4c.js";import"./axios-4a70c6fc.js";import"./react-router-dom-60901e53.js";import"./@remix-run-d753ad9e.js";import"./icons-material-4539f19e.js";import"./react-icons-55b3b9a0.js";import"./use-sync-external-store-18921cc2.js";const w={owner:"",vehicleType:"",vehicleNo:"",make:"",capacity:"",regDate:null,chassisNo:"",engineNo:"",description:"",taxDetails:[]},C={owner:{invalid:!1,message:""},vehicleType:{invalid:!1,message:""},vehicleNo:{invalid:!1,message:""},taxDetails:{invalid:!1,message:""}},Ge=()=>{const{suppliers:o,vehicleTypes:m}=A(({vehicle:t})=>t),[n,d]=u.useState(w),[l,Y]=u.useState(w),[c,z]=u.useState(C),[k,h]=u.useState(""),[D,F]=u.useState(null),S=A(U),f=re(),W=ne(),I=le(),{vehicleId:x}=I.state,L=u.useCallback(()=>{W("/master/vehicles")},[W]);u.useEffect(()=>{var t,a;d({...l,owner:(t=o==null?void 0:o.find)==null?void 0:t.call(o,({_id:i})=>(l==null?void 0:l.owner)===i),vehicleType:(a=m==null?void 0:m.find)==null?void 0:a.call(m,({_id:i})=>(l==null?void 0:l.vehicleType)===i)})},[o,l,m]),u.useEffect(()=>{x&&f(X(x)).then(({payload:t={}})=>{const{message:a,regDate:i}=(t==null?void 0:t.data)||{};a?h(a):(i&&(t.data.regDate=Q(i)),d(t==null?void 0:t.data),Y(t==null?void 0:t.data))}).catch(t=>{h(t.message)})},[x]),u.useEffect(()=>{f(Z())},[]),u.useEffect(()=>{f($())},[]);const _=()=>{var t,a;d({...l,owner:(t=o==null?void 0:o.find)==null?void 0:t.call(o,({_id:i})=>(l==null?void 0:l.owner)===i),vehicleType:(a=m==null?void 0:m.find)==null?void 0:a.call(m,({_id:i})=>(l==null?void 0:l.vehicleType)===i)}),h(""),z(C)},y=()=>{L()},E=t=>{const a=t.target.name,i=t.target.value;d(r=>({...r,[a]:i}))},V=(t,a)=>{d(i=>({...i,[a]:t}))},B=(t,a)=>{d(i=>({...i,[t]:a}))},M=t=>{var a,i;t.preventDefault(),P(n)||f(te({...n,owner:(a=n==null?void 0:n.owner)==null?void 0:a._id,vehicleType:(i=n==null?void 0:n.vehicleType)==null?void 0:i._id})).then(({payload:r={}})=>{const{message:s}=(r==null?void 0:r.data)||{};s?h(s):(h(""),d(w),L())}).catch(r=>{h(r.message)})},P=t=>{var r,s,p,N;const a={...C};(r=t.owner)!=null&&r.label||(a.owner={invalid:!0,message:"Supplier is required"}),(s=t.vehicleType)!=null&&s.label||(a.vehicleType={invalid:!0,message:"Vehicle type is required"}),(N=(p=t.vehicleNo)==null?void 0:p.trim)!=null&&N.call(p)||(a.vehicleNo={invalid:!0,message:"Vehicle number is required"});let i=!1;for(const q in a)a[q].invalid===!0&&(i=!0);return i&&z(a),i},R=t=>{if(!D)d(a=>{var r,s;const i={...a};return(s=(r=i.taxDetails)==null?void 0:r.push)==null||s.call(r,t),i});else{const a={...D},i={...t};delete i.index,d(r=>{const s={...r},p=[...r.taxDetails];return p[a.index]={...i},s.taxDetails=[...p],s}),F(null)}},O=t=>{F({...n.taxDetails[t],index:t})},j=t=>{d(a=>{var r,s;const i={...a};return i.taxDetails=(s=(r=i.taxDetails)==null?void 0:r.filter)==null?void 0:s.call(r,(p,N)=>N!==t),i})};return e.createElement(e.Fragment,null,S&&e.createElement(ee,null),e.createElement("h1",{className:"pageHead"},"Edit a vehicle"),k!==""&&e.createElement(se,{sx:{width:"100%",margin:"0 0 30px 0",border:"1px solid red",borderRadius:"4px"},spacing:2},e.createElement(oe,{severity:"error"},k)),!S&&e.createElement("div",null,e.createElement("form",{action:"",id:"customerForm",onSubmit:M},e.createElement(me,{sx:{padding:"20px",marginBottom:"20px"}},e.createElement("div",{className:"grid grid-6-col"},e.createElement("div",{className:"grid-item"},e.createElement(v,{fullWidth:!0,size:"small",error:c.owner.invalid},e.createElement(H,{disablePortal:!0,autoSelect:!0,size:"small",name:"owner",options:o,value:n.owner||"",onChange:(t,a)=>V(a,"owner"),openOnFocus:!0,renderInput:t=>e.createElement(g,{...t,label:"Vehicle supplier",error:c.owner.invalid,fullWidth:!0})}),c.owner.invalid&&e.createElement(b,null,c.owner.message))),e.createElement("div",{className:"grid-item"},e.createElement(v,{fullWidth:!0,error:c.vehicleNo.invalid},e.createElement(g,{size:"small",variant:"outlined",label:"Vehicle number",value:n.vehicleNo,error:c.vehicleNo.invalid,onChange:E,name:"vehicleNo",id:"vehicleNo"}),c.vehicleNo.invalid&&e.createElement(b,null,c.vehicleNo.message))),e.createElement("div",{className:"grid-item"},e.createElement(v,{fullWidth:!0,size:"small",error:c.vehicleType.invalid},e.createElement(H,{disablePortal:!0,size:"small",name:"vehicleType",options:m,value:n.vehicleType||"",onChange:(t,a)=>V(a,"vehicleType"),openOnFocus:!0,renderInput:t=>e.createElement(g,{...t,label:"Vehicle type",error:c.vehicleType.invalid,fullWidth:!0})}),c.vehicleType.invalid&&e.createElement(b,null,c.vehicleType.message))),e.createElement("div",{className:"grid-item"},e.createElement(v,{fullWidth:!0},e.createElement(g,{size:"small",variant:"outlined",label:"Make",value:n.make,onChange:E,name:"make",id:"make"}))),e.createElement("div",{className:"grid-item"},e.createElement(v,{fullWidth:!0},e.createElement(g,{size:"small",variant:"outlined",label:"Capacity",value:n.capacity,onChange:E,name:"capacity",id:"capacity"}))),e.createElement("div",{className:"grid-item"},e.createElement(v,{fullWidth:!0,error:!0},e.createElement(G,{dateAdapter:J},e.createElement(K,{label:"Registration date",inputFormat:"DD/MM/YYYY",format:"DD/MM/YYYY",value:n.regDate,disableFuture:!0,onChange:B.bind(null,"regDate"),renderInput:t=>e.createElement(g,{name:"regDate",size:"small",...t})})))),e.createElement("div",{className:"grid-item"},e.createElement(v,{fullWidth:!0},e.createElement(g,{size:"small",variant:"outlined",label:"Chassis number",value:n.chassisNo,onChange:E,name:"chassisNo",id:"chassisNo"}))),e.createElement("div",{className:"grid-item"},e.createElement(v,{fullWidth:!0},e.createElement(g,{size:"small",variant:"outlined",label:"Engine number",value:n.engineNo,onChange:E,name:"engineNo",id:"engineNo"}))),e.createElement("div",{className:"grid-item"},e.createElement(v,{fullWidth:!0},e.createElement(g,{size:"small",variant:"outlined",label:"Description",value:n.description,onChange:E,name:"description",id:"description"})))))),e.createElement("div",{className:"bl_contact_person"},e.createElement("div",{className:"bl_form"},e.createElement(ae,{onTaxDetailAdd:R,editTaxDetail:D})),e.createElement("div",{className:"bl_content"},e.createElement(ie,{taxDetails:n.taxDetails,handleTriggerEdit:O,handleTriggerDelete:j}))),e.createElement("div",{className:"right"},e.createElement(T,{variant:"outlined",size:"medium",onClick:y},"Back"),e.createElement(T,{variant:"outlined",size:"medium",onClick:_,className:"ml6"},"Reset"),e.createElement(T,{variant:"contained",size:"medium",type:"submit",color:"primary",form:"customerForm",className:"ml6"},"Save"))))};export{Ge as default};
