import{r as v,a as e}from"./react-bfabd40c.js";import{u as A,a as V}from"./react-redux-45d870ba.js";import{f as _}from"./icons-material-4539f19e.js";import{L as F,A as x,D as N}from"./x-date-pickers-7b1cc7dd.js";import"./Card.module-3bdbfb7f.js";import{cR as X,L as G,cX as J}from"./index-5f564d13.js";import{S as K}from"./Stations-22d95b0d.js";import{a as U}from"./react-router-1b5f20a2.js";import{O as Z,Q as $,a as ee,i as d,h as u,V as p,D as R,a5 as te,a6 as ae,a7 as re,a8 as B,a9 as o,aa as ie,f as le,l as P}from"./material-e0a59a28.js";import"./@babel-e11bafe1.js";import"./react-dom-b0178e93.js";import"./scheduler-765c72db.js";import"./hoist-non-react-statics-6cfbf744.js";import"./use-sync-external-store-18921cc2.js";import"./@date-io-f382d426.js";import"./dayjs-7f45ce31.js";import"./utils-c03c978f.js";import"./clsx-1229b3e0.js";import"./base-ff50cfe3.js";import"./@popperjs-f3391c26.js";import"./rifm-7b0f12ad.js";import"./system-a1d29c52.js";import"./styled-engine-f3bd09bf.js";import"./@emotion-77835cc8.js";import"./stylis-79144faa.js";import"./private-theming-970ac73c.js";import"./react-transition-group-7ded6f4d.js";import"./dom-helpers-9a525042.js";import"./redux-persist-d9cc1560.js";import"./redux-b7ba668d.js";import"./@reduxjs-4d37e7cf.js";import"./immer-41fd5235.js";import"./redux-thunk-ef899f4c.js";import"./axios-4a70c6fc.js";import"./react-router-dom-4405dfe9.js";import"./@remix-run-d753ad9e.js";import"./react-icons-55b3b9a0.js";const z={date:new Date,customer:"",from:null,to:null,otherField:"",ratePer:"",stations:[]},f={date:{invalid:!1,message:""},customer:{invalid:!1,message:""},from:{invalid:!1,message:""},to:{invalid:!1,message:""},ratePer:{invalid:!1,message:""},stations:{invalid:!1,message:""}},je=()=>{var T,g,k;const L=A(X),[i,m]=v.useState(z),[a,h]=v.useState(f),[D,E]=v.useState(""),{places:w}=A(({quotation:t})=>t)||{},q=U(),I=V(),Y=v.useCallback(()=>{q("/transactions/quotations")},[q]),M=()=>{m(z),E(""),h(f)},W=()=>{Y()},b=t=>{const r=t.target.name,l=t.target.value;m(n=>({...n,[r]:l}))},y=t=>{t.preventDefault(),Q(i)||I(J(i)).then(({payload:r={}})=>{const{message:l}=(r==null?void 0:r.data)||{};l?E(l):(E(""),h(f),m(z),Y())}).catch(r=>{E(r.message)})},Q=t=>{var n,s,c,H,S;const r={...f};t.date||(r.date={invalid:!0,message:"Date is required"}),(s=(n=t.customer)==null?void 0:n.trim)!=null&&s.call(n)||(r.customer={invalid:!0,message:"Customer is required"}),t.from||(r.from={invalid:!0,message:"From date is required"}),t.to||(r.to={invalid:!0,message:"To date is required"}),(H=(c=t.ratePer)==null?void 0:c.trim)!=null&&H.call(c)||(r.ratePer={invalid:!0,message:"Rate type is required"}),(S=t.stations)!=null&&S.length||(r.stations={invalid:!0,message:"At least one entry is required"});let l=!1;for(const O in r)r[O].invalid===!0&&(l=!0);return l&&h(r),l},C=(t,r)=>{m(l=>({...l,[t]:new Date(r)}))},j=(t,r)=>{var l,n;if(t.preventDefault(),(l=i.stations)!=null&&l.length){const s=i.stations;(n=s==null?void 0:s.splice)==null||n.call(s,r,1),m(c=>({...c,stations:s}))}};return e.createElement(e.Fragment,null,L&&e.createElement(G,null),e.createElement("h1",{className:"pageHead"},"Add a quotation"),e.createElement("div",{className:"inner-wrap"},D!==""&&e.createElement(Z,{sx:{width:"100%",margin:"0 0 30px 0",border:"1px solid red",borderRadius:"4px"},spacing:2},e.createElement($,{severity:"error"},D)),e.createElement(ee,{sx:{padding:"20px",marginBottom:"20px"}},e.createElement("form",{action:"",onSubmit:y,id:"quotationForm"},e.createElement("div",{className:"grid grid-6-col"},e.createElement("div",{className:"grid-item"},e.createElement(d,{fullWidth:!0,error:a.date.invalid},e.createElement(F,{dateAdapter:x},e.createElement(N,{error:a.date.invalid,label:"Date",inputFormat:"DD/MM/YYYY",value:i.date,onChange:C.bind(null,"date"),renderInput:t=>e.createElement(u,{name:"date",size:"small",autoComplete:"off",...t,error:a.date.invalid})})),a.date.invalid&&e.createElement(p,null,a.date.message))),e.createElement("div",{className:"grid-item"},e.createElement(d,{fullWidth:!0,size:"small",error:a.customer.invalid},e.createElement(u,{size:"small",variant:"outlined",label:"Customer",error:a.customer.invalid,value:i.customer,onChange:b,name:"customer",id:"customer"}),a.customer.invalid&&e.createElement(p,null,a.customer.message))),e.createElement("div",{className:"grid-item"},e.createElement(d,{fullWidth:!0,error:a.from.invalid},e.createElement(F,{dateAdapter:x},e.createElement(N,{error:a.from.invalid,label:"From date",inputFormat:"DD/MM/YYYY",value:i.from,onChange:C.bind(null,"from"),renderInput:t=>e.createElement(u,{name:"from",size:"small",autoComplete:"off",...t,error:a.from.invalid})})),a.from.invalid&&e.createElement(p,null,a.from.message))),e.createElement("div",{className:"grid-item"},e.createElement(d,{fullWidth:!0,error:a.to.invalid},e.createElement(F,{dateAdapter:x},e.createElement(N,{error:a.to.invalid,label:"To date",inputFormat:"DD/MM/YYYY",value:i.to,onChange:C.bind(null,"to"),renderInput:t=>e.createElement(u,{name:"to",size:"small",autoComplete:"off",...t,error:a.to.invalid})})),a.to.invalid&&e.createElement(p,null,a.to.message))),e.createElement("div",{className:"grid-item"},e.createElement(d,{fullWidth:!0,size:"small",error:a.ratePer.invalid},e.createElement(u,{size:"small",variant:"outlined",label:"Rate per",value:i.ratePer,error:a.ratePer.invalid,onChange:b,name:"ratePer",id:"ratePer"}),a.ratePer.invalid&&e.createElement(p,null,a.ratePer.message))),e.createElement("div",{className:"grid-item"},e.createElement(d,{fullWidth:!0,size:"small"},e.createElement(u,{size:"small",variant:"outlined",label:"Other header field",value:i.otherField,onChange:b,name:"otherField",id:"otherField"}))))),e.createElement(R,{sx:{margin:"20px 0"}}),a.stations.invalid&&e.createElement("p",{className:"error"},a.stations.message),e.createElement(K,{places:w,quotation:i,setQuotation:m}),((T=i.stations)==null?void 0:T.length)>0?e.createElement(te,null,e.createElement(ae,{sx:{width:500},className:"tbl_jsm"},e.createElement(re,null,e.createElement(B,null,e.createElement(o,null,"Station"),e.createElement(o,{align:"right"},"Rate per ",i.ratePer),e.createElement(o,{align:"right"},i.otherField),e.createElement(o,{align:"right"}," "))),e.createElement(ie,null,(k=(g=i.stations)==null?void 0:g.map)==null?void 0:k.call(g,(t,r)=>e.createElement(B,{key:r,sx:{"&:last-child td, &:last-child th":{border:0}}},e.createElement(o,null,t.station),e.createElement(o,{align:"right"},"₹ ",t.amount),e.createElement(o,{align:"right"},"₹ ",t.otherFieldValue),e.createElement(o,null,e.createElement(le,{size:"small",onClick:l=>j(l,r),color:"error"},e.createElement(_,null)))))))):null,e.createElement(R,{sx:{margin:"20px 0"}}),e.createElement("div",{className:"right"},e.createElement(P,{variant:"outlined",size:"medium",onClick:W},"Back"),e.createElement(P,{variant:"outlined",size:"medium",onClick:M,className:"ml6"},"Reset"),e.createElement(P,{variant:"contained",size:"medium",type:"submit",color:"primary",form:"quotationForm",className:"ml6"},"Save")))))};export{je as default};
