import{r as n,a as t}from"./react-bfabd40c.js";import{c as J,e as K,f as U}from"./icons-material-4539f19e.js";import"./Card.module-3bdbfb7f.js";import{C as X}from"./Dialog-cfe6f9ef.js";import{ck as Y,cl as Z,L as V,cm as y,a4 as ee,cn as te,co as re,cp as se}from"./index-66f971e4.js";import{u as S,a as ae}from"./react-redux-45d870ba.js";import{a as ne}from"./react-router-622b2d59.js";import{u as oe,D as ie,G as ce}from"./x-data-grid-cceece3f.js";import{j as me}from"./utils-c03c978f.js";import{i as le,A as ue,h as F,l as de,O as fe,Q as pe,m as ge,f as I}from"./material-e0a59a28.js";import"./@babel-e11bafe1.js";import"./react-dom-b0178e93.js";import"./scheduler-765c72db.js";import"./redux-persist-d9cc1560.js";import"./redux-b7ba668d.js";import"./@reduxjs-4d37e7cf.js";import"./immer-41fd5235.js";import"./redux-thunk-ef899f4c.js";import"./axios-4a70c6fc.js";import"./hoist-non-react-statics-6cfbf744.js";import"./react-router-dom-60901e53.js";import"./@remix-run-d753ad9e.js";import"./react-icons-55b3b9a0.js";import"./use-sync-external-store-18921cc2.js";import"./system-a1d29c52.js";import"./styled-engine-f3bd09bf.js";import"./@emotion-77835cc8.js";import"./stylis-79144faa.js";import"./private-theming-970ac73c.js";import"./react-transition-group-7ded6f4d.js";import"./dom-helpers-9a525042.js";import"./base-ff50cfe3.js";import"./@popperjs-f3391c26.js";import"./clsx-1229b3e0.js";import"./prop-types-d7fd566a.js";import"./reselect-36a88051.js";const Ve=()=>{var h,A,E,M;const T=[{field:"_id",headerName:"Id"},{field:"pettyCashNo",headerName:"Petty cash no.",flex:1},{field:"transferToBranch",headerName:"Transfer to branch",flex:1},{field:"date",headerName:"Date",flex:1},{field:"amount",headerName:"Amount",flex:1,renderCell:e=>t.createElement("strong",null,"â‚¹ ",e.row.amount)},{field:"actions",headerName:"Action",flex:1,sortable:!1,renderCell:e=>{const r=a=>(a.stopPropagation(),j(e.row._id)),s=a=>(a.stopPropagation(),Q(e.row._id));return t.createElement(t.Fragment,null,t.createElement(I,{size:"small",onClick:s,color:"primary"},t.createElement(K,null)),t.createElement(I,{size:"small",onClick:r,color:"error"},t.createElement(U,null)))}}],u=S(e=>e.user),P=S(Y),{search:f}=S(({moneytransfer:e})=>e),p=ae(),N=ne(),[i,k]=n.useState([]),[m,b]=n.useState(null),[d,B]=n.useState([]),[v,l]=n.useState(""),[L,g]=n.useState(!1),[O,z]=n.useState(""),[R,_]=n.useState(!1),x=oe();n.useEffect(()=>{p(Z()).then(({payload:e={}})=>{var s,a,o;const{message:r}=(e==null?void 0:e.data)||{};if(r)l(r);else if(l(""),k(e==null?void 0:e.data),(s=e==null?void 0:e.data)!=null&&s.length){const c=(o=(a=e==null?void 0:e.data)==null?void 0:a.filter)==null?void 0:o.call(a,C=>C._id===u.branch);c!=null&&c.length&&b(c[0])}}).catch(()=>{l("Something went wrong! Please try later or contact Administrator.")})},[]);const w=()=>{p(y(m._id)).then(({payload:e={}})=>{var s,a;const{message:r}=(e==null?void 0:e.data)||{};r?l(r):B((a=(s=e==null?void 0:e.data)==null?void 0:s.map)==null?void 0:a.call(s,o=>{var c,C;return{...o,amount:(C=(c=o.amount)==null?void 0:c.toFixed)==null?void 0:C.call(c,2),date:ee(new Date(o.date)),pettyCashNo:te(o.pettyCashNo),transferToBranch:H(o.transferToBranch)}}))}).catch(e=>{l(e.message)})};n.useEffect(()=>{m!=null&&m._id&&w()},[m]);const D=n.useMemo(()=>me(e=>{var r,s,a;x.current.setQuickFilterValues((a=(s=(r=e.split)==null?void 0:r.call(e," "))==null?void 0:s.filter)==null?void 0:a.call(s,o=>o!==""))},500),[x]);n.useEffect(()=>{f&&(d!=null&&d.length)&&(_(!0),D(f),setTimeout(()=>{_(!1)},500))},[d]);const G=e=>{D(e.target.value),p(re(e.target.value))},H=e=>{var r;if(i!=null&&i.length){const s=(r=i==null?void 0:i.find)==null?void 0:r.call(i,a=>a._id===e);return s?s.name:e}return e},j=e=>{z(e),g(!0)},Q=e=>{N("/transactions/moneyTransfers/editMoneyTransfer",{state:{mtId:e}})},$=e=>{g(!0),e.target.value==="true"?p(se(O)).then(({payload:r={}})=>{const{message:s}=(r==null?void 0:r.data)||{};s?l(s):(w(),g(!1))}).catch(r=>{l(r.message)}):g(!1)},W=(e,r)=>{b(r)},q=()=>{N("/transactions/moneyTransfers/addMoneyTransfer",{state:m})};return t.createElement(t.Fragment,null,(P||R)&&t.createElement(V,null),t.createElement("div",{className:"inner-wrap"},L&&t.createElement(X,{isOpen:!0,onClose:$,title:"Are you sure?",content:"Do you want to delete the money transfer?",warning:!0}),t.createElement("div",{className:"page_head"},t.createElement("h1",{className:"pageHead"},"Money transfers"),t.createElement("div",{className:"page_actions"},t.createElement(le,{size:"small",sx:{width:"230px",marginRight:"5px"}},t.createElement(ue,{disablePortal:!0,size:"small",name:"branch",className:"multi-select",options:i,value:m||null,onChange:W,disabled:u&&u.type&&((A=(h=u.type)==null?void 0:h.toLowerCase)==null?void 0:A.call(h))!=="superadmin"&&((M=(E=u.type)==null?void 0:E.toLowerCase)==null?void 0:M.call(E))!=="admin",getOptionLabel:e=>e.name,openOnFocus:!0,renderInput:e=>t.createElement(F,{...e,label:"Select branch",fullWidth:!0})})),t.createElement(de,{variant:"contained",size:"small",type:"button",color:"primary",className:"ml6",onClick:q},"Add a money transfer"))),v!==""&&t.createElement(fe,{sx:{width:"100%",margin:"0 0 30px 0",border:"1px solid red",borderRadius:"4px"},spacing:2},t.createElement(pe,{severity:"error"},v)),t.createElement("div",{style:{width:"100%"}},t.createElement(ie,{apiRef:x,sx:{backgroundColor:"primary.contrastText"},autoHeight:!0,density:"compact",getRowId:e=>e._id,rows:d,columns:T,initialState:{...T,columns:{columnVisibilityModel:{_id:!1}}},components:{Toolbar:()=>t.createElement(ce,{sx:{gap:"6px",mb:"10px",justifyContent:"end",border:"none"}},t.createElement(F,{variant:"standard",placeholder:"Search...",autoFocus:!!f,onChange:G,value:f,InputProps:{startAdornment:t.createElement(ge,{position:"start"},t.createElement(J,null))}}))},pageSize:10,rowsPerPageOptions:[10],disableSelectionOnClick:!0}))))};export{Ve as default};
