import{r as c,a as t}from"./react-69b9bddd.js";import{L as Ce,A as Ie,D as Pe}from"./x-date-pickers-f3802fc3.js";import"./Card.module-3bdbfb7f.js";import{cy as Be,cz as ze,cF as Fe,cG as _e,cH as xe,cI as He,cA as Le,cJ as We,cK as De,cL as qe,L as Me,bt as Re,cM as Ye}from"./index-1d9d8716.js";import{u as ne,a as Oe}from"./react-redux-13959126.js";import{a as je}from"./react-router-7dadf37a.js";import{O as Ge,Q as Je,a3 as Ke,a4 as re,a as Qe,i as v,o as p,j as C,b as d,V as N,h as L,m as ie,ab as Ve,F as se,ac as me,l as D}from"./material-04052d9a.js";import"./@babel-5e587562.js";import"./@date-io-28dabb9c.js";import"./dayjs-39ab3f8d.js";import"./utils-49fe0532.js";import"./clsx-1229b3e0.js";import"./base-e8cfb5a9.js";import"./react-dom-69e96a05.js";import"./scheduler-765c72db.js";import"./@popperjs-f3391c26.js";import"./rifm-bf33b601.js";import"./system-49be6911.js";import"./styled-engine-f8044af8.js";import"./@emotion-17579717.js";import"./hoist-non-react-statics-1d21e5a8.js";import"./stylis-79144faa.js";import"./private-theming-ec89146b.js";import"./react-transition-group-deabed87.js";import"./dom-helpers-9a525042.js";import"./redux-persist-a379f351.js";import"./redux-fa075741.js";import"./@reduxjs-2459f64e.js";import"./immer-41fd5235.js";import"./redux-thunk-ef899f4c.js";import"./axios-21b846bc.js";import"./react-router-dom-38324838.js";import"./@remix-run-8989dd9f.js";import"./icons-material-40f8e5d8.js";import"./react-icons-6bc9af43.js";import"./use-sync-external-store-20ba4de3.js";const Ft=()=>{var G,J,K,Q,V,U,X,Z;const q={branch:"",transactionType:"",transactionName:"",type:"",lsNo:"",amount:"",availableBal:"",date:new Date,bank:"",bankAccountNumber:"",description:""},W={branch:{invalid:!1,message:""},type:{invalid:!1,message:""},amount:{invalid:!1,message:""},date:{invalid:!1,message:""},transactionType:{invalid:!1,message:""},transactionName:{invalid:!1,message:""},bank:{invalid:!1,message:""},bankAccountNumber:{invalid:!1,message:""},description:{invalid:!1,message:""}},ce=ne(Be),[o,le]=c.useState([]),[f,oe]=c.useState([]),[k,ue]=c.useState([]),[w,de]=c.useState([]),[A,ge]=c.useState([]),[I,ve]=c.useState([]),[P,he]=c.useState([]),[B,Ee]=c.useState([]),[M,n]=c.useState(""),[s,S]=c.useState(q),[r,R]=c.useState(W),[u,be]=c.useState([]),[b,Ne]=c.useState("transaction"),Y=je(),O=ne(e=>e.user),h=Oe(),j=c.useCallback(()=>{Y("/transactions/pettyCashHistory")},[Y]);c.useEffect(()=>{h(ze()).then(({payload:e={}})=>{var i,l,T;const{message:a}=(e==null?void 0:e.data)||{};if(a)n(a);else if(n(""),le(e==null?void 0:e.data),(i=e==null?void 0:e.data)!=null&&i.length){const m=(T=(l=e==null?void 0:e.data)==null?void 0:l.filter)==null?void 0:T.call(l,E=>E._id===O.branch);m!=null&&m.length&&S(E=>({...E,branch:m[0]._id}))}}).catch(()=>{n("Something went wrong! Please try later or contact Administrator.")}),h(Fe()).then(({payload:e={}})=>{const{message:a}=(e==null?void 0:e.data)||{};a?n("Something went wrong! Please try later or contact Administrator."):(n(""),ge(e==null?void 0:e.data))}).catch(()=>{n("Something went wrong! Please try later or contact Administrator.")}),h(_e()).then(({payload:e={}})=>{const{message:a}=(e==null?void 0:e.data)||{};a?n("Something went wrong! Please try later or contact Administrator."):(n(""),oe(e==null?void 0:e.data))}).catch(()=>{n("Something went wrong! Please try later or contact Administrator.")}),h(xe()).then(({payload:e={}})=>{const{message:a}=(e==null?void 0:e.data)||{};a?n("Something went wrong! Please try later or contact Administrator."):(n(""),ue(e==null?void 0:e.data))}).catch(()=>{n("Something went wrong! Please try later or contact Administrator.")}),h(He()).then(({payload:e={}})=>{const{message:a}=(e==null?void 0:e.data)||{};a?n("Something went wrong! Please try later or contact Administrator."):(n(""),de(e==null?void 0:e.data))}).catch(()=>{n("Something went wrong! Please try later or contact Administrator.")}),h(Le()).then(({payload:e={}})=>{const{message:a}=(e==null?void 0:e.data)||{};a?n("Something went wrong! Please try later or contact Administrator."):(n(""),ve(e==null?void 0:e.data))}).catch(()=>{n("Something went wrong! Please try later or contact Administrator.")}),h(We()).then(({payload:e={}})=>{const{message:a}=(e==null?void 0:e.data)||{};a?n("Something went wrong! Please try later or contact Administrator."):(n(""),he(e==null?void 0:e.data))}).catch(()=>{n("Something went wrong! Please try later or contact Administrator.")}),h(De()).then(({payload:e={}})=>{const{message:a}=(e==null?void 0:e.data)||{};a?n("Something went wrong! Please try later or contact Administrator."):(n(""),S(i=>({...i,availableBal:e==null?void 0:e.data.balance})))}).catch(()=>{n("Something went wrong! Please try later or contact Administrator.")})},[]),c.useEffect(()=>{s.branch&&h(qe({branch:s.branch,pagination:{limit:100,page:1}})).then(({payload:e={}})=>{const{message:a}=(e==null?void 0:e.data)||{};a?n(a):(n(""),be(e==null?void 0:e.data))}).catch(()=>{n("Something went wrong! Please try later or contact Administrator.")})},[s.branch]);const fe=()=>{var i;let e;const a=(i=o==null?void 0:o.filter)==null?void 0:i.call(o,l=>l._id===O.branch);a!=null&&a.length&&(e=a[0]._id),S(()=>({...q,branch:e})),n(""),R(W)},ke=()=>{j()},g=e=>{var l,T;const a=e.target.name,i=e.target.value;if(S(m=>({...m,[a]:i})),a==="transactionType"&&S(m=>({...m,transactionName:""})),a==="bank"&&Ee((l=P==null?void 0:P.filter)==null?void 0:l.call(P,m=>m.bank===i)),a==="lsNo"){const m=(T=u==null?void 0:u.filter)==null?void 0:T.call(u,E=>E.lsNo===i)[0];S(E=>({...E,amount:m==null?void 0:m.advance}))}},we=(e,a)=>{S(i=>({...i,[e]:new Date(a)}))},Ae=(e,a)=>{Ne(a),S(i=>({...i,bank:"",bankAccountNumber:"",transactionType:"",transactionName:"",lsNo:"",amount:""}))},Se=e=>{e.preventDefault(),Te(s)||h(Ye(s)).then(({payload:a={}})=>{const{message:i}=(a==null?void 0:a.data)||{};i?n(i):(n(""),j())}).catch(a=>{n(a.message)})},Te=e=>{var l,T,m,E,z,$,F,y,_,ee,x,te,H,ae;const a={...W};(T=(l=e.branch)==null?void 0:l.trim)!=null&&T.call(l)||(a.branch={invalid:!0,message:"Branch is required"}),(isNaN(e.amount)||e.amount<=0)&&(a.amount={invalid:!0,message:"Amount should be a number and greater than 0"}),e.date||(a.date={invalid:!0,message:"Date is required"}),(E=(m=e.description)==null?void 0:m.trim)!=null&&E.call(m)||(a.description={invalid:!0,message:"Description is required"}),($=(z=e.type)==null?void 0:z.trim)!=null&&$.call(z)||(a.type={invalid:!0,message:"Debit / Credit is required"}),b==="transaction"&&!((y=(F=e.transactionType)==null?void 0:F.trim)!=null&&y.call(F))&&(a.transactionType={invalid:!0,message:"Transaction type is required"}),b==="transaction"&&!((ee=(_=e.transactionName)==null?void 0:_.trim)!=null&&ee.call(_))&&(a.transactionName={invalid:!0,message:"Transaction name is required"}),b==="transfer"&&!((te=(x=e.bank)==null?void 0:x.trim)!=null&&te.call(x))&&(a.bank={invalid:!0,message:"Bank is required"}),b==="transfer"&&!((ae=(H=e.bankAccountNumber)==null?void 0:H.trim)!=null&&ae.call(H))&&(a.bankAccountNumber={invalid:!0,message:"Bank account number is required"});let i=!1;for(const pe in a)a[pe].invalid===!0&&(i=!0);return i&&R(a),i};return t.createElement(t.Fragment,null,ce&&t.createElement(Me,null),t.createElement("h1",{className:"pageHead"},"Add a money transfer"),M!==""&&t.createElement(Ge,{sx:{width:"100%",margin:"0 0 30px 0",border:"1px solid red",borderRadius:"4px"},spacing:2},t.createElement(Je,{severity:"error"},M)),t.createElement(Ke,{value:b,onChange:Ae},t.createElement(re,{value:"transaction",label:"New transaction",wrapped:!0}),t.createElement(re,{value:"transfer",label:"Transfer in petty cash",wrapped:!0})),t.createElement("form",{action:"",onSubmit:Se},t.createElement(Qe,{sx:{padding:"20px",marginBottom:"20px"}},t.createElement("div",{className:"grid grid-6-col"},t.createElement("div",{className:"grid-item"},t.createElement(v,{fullWidth:!0,size:"small",error:r.branch.invalid},t.createElement(p,{id:"branch"},"Branch"),t.createElement(C,{labelId:"branch",name:"branch",label:"Branch",value:s.branch,onChange:g},(o==null?void 0:o.length)>0&&((G=o==null?void 0:o.map)==null?void 0:G.call(o,e=>t.createElement(d,{key:e._id,value:e._id,className:"menuItem"},e.name)))),r.branch.invalid&&t.createElement(N,null,r.branch.message))),t.createElement("div",{className:"grid-item"},t.createElement(v,{fullWidth:!0},t.createElement(L,{size:"small",variant:"outlined",label:"Available balance",value:s.availableBal,onChange:g,name:"availableBal",id:"availableBal",InputProps:{readOnly:!0,startAdornment:t.createElement(ie,{position:"start"},"â‚¹")}}))),t.createElement("div",{className:"grid-item"},t.createElement(v,{fullWidth:!0,error:r.date.invalid},t.createElement(Ce,{dateAdapter:Ie},t.createElement(Pe,{label:"Date",inputFormat:"DD/MM/YYYY",value:s.date,disableFuture:!0,disableMaskedInput:!0,onChange:we.bind(null,"date"),inputProps:{readOnly:!0},renderInput:e=>t.createElement(L,{name:"date",size:"small",...e,error:r.date.invalid})})),r.date.invalid&&t.createElement(N,null,r.date.message))),t.createElement("div",{className:"grid-item"},t.createElement(v,{fullWidth:!0,sx:{alignItems:"center"},error:r.type.invalid},t.createElement(Ve,{row:!0,name:"type"},t.createElement(se,{value:"debit",control:t.createElement(me,{size:"small"}),label:"Debit",onChange:g}),t.createElement(se,{value:"credit",control:t.createElement(me,{size:"small"}),label:"Credit",onChange:g})),r.type.invalid&&t.createElement(N,null,r.type.message))),b==="transaction"&&t.createElement("div",{className:"grid-item"},t.createElement(v,{fullWidth:!0,size:"small"},t.createElement(p,{id:"challanAdance"},"Challan advance"),t.createElement(C,{labelId:"challanAdance",name:"lsNo",label:"Challan advance",value:s.lsNo,onChange:g},(u==null?void 0:u.length)>0&&((J=u==null?void 0:u.map)==null?void 0:J.call(u,e=>t.createElement(d,{key:e._id,value:e.lsNo,className:"menuItem"},Re(e.lsNo))))))),t.createElement("div",{className:"grid-item"},t.createElement(v,{fullWidth:!0,error:r.amount.invalid},t.createElement(L,{size:"small",variant:"outlined",label:"Amount",value:s.amount,error:r.amount.invalid,onChange:g,name:"amount",id:"amount",InputProps:{startAdornment:t.createElement(ie,{position:"start"},"â‚¹")}}),r.amount.invalid&&t.createElement(N,null,r.amount.message))),b==="transaction"&&t.createElement("div",{className:"grid-item"},t.createElement(v,{fullWidth:!0,size:"small",error:r.transactionType.invalid},t.createElement(p,{id:"transactionType"},"Type"),t.createElement(C,{labelId:"transactionType",name:"transactionType",label:"Type",value:s.transactionType,onChange:g},t.createElement(d,{key:"Customer",value:"customer",className:"menuItem"},"Customer"),t.createElement(d,{key:"Driver",value:"driver",className:"menuItem"},"Driver"),t.createElement(d,{key:"Employee",value:"employee",className:"menuItem"},"Employee"),t.createElement(d,{key:"Supplier",value:"supplier",className:"menuItem"},"Supplier")),r.transactionType.invalid&&t.createElement(N,null,r.transactionType.message))),b==="transaction"&&(w==null?void 0:w.length)>0&&(k==null?void 0:k.length)>0&&(A==null?void 0:A.length)>0&&(f==null?void 0:f.length)>0&&t.createElement("div",{className:"grid-item"},t.createElement(v,{fullWidth:!0,size:"small",error:r.transactionName.invalid},t.createElement(p,{id:"typeName"},"Type name"),t.createElement(C,{labelId:"typeName",name:"transactionName",label:"Type name",value:s.transactionName,onChange:g},s.transactionType==="customer"&&((K=w==null?void 0:w.map)==null?void 0:K.call(w,e=>t.createElement(d,{key:e._id,value:e.name,className:"menuItem"},e.name))),s.transactionType==="driver"&&((Q=k==null?void 0:k.map)==null?void 0:Q.call(k,e=>t.createElement(d,{key:e._id,value:e.name,className:"menuItem"},e.name))),s.transactionType==="employee"&&((V=A==null?void 0:A.map)==null?void 0:V.call(A,e=>t.createElement(d,{key:e._id,value:e.name,className:"menuItem"},e.name))),s.transactionType==="supplier"&&((U=f==null?void 0:f.map)==null?void 0:U.call(f,e=>t.createElement(d,{key:e._id,value:e.name,className:"menuItem"},e.name)))),r.transactionName.invalid&&t.createElement(N,null,r.transactionName.message))),b==="transfer"&&t.createElement(t.Fragment,null,t.createElement("div",{className:"grid-item"}),t.createElement("div",{className:"grid-item"},t.createElement(v,{fullWidth:!0,size:"small",error:r.bank.invalid},t.createElement(p,{id:"typeName"},"Bank"),t.createElement(C,{labelId:"typeName",name:"bank",label:"Bank",value:s.bank,onChange:g},(X=I==null?void 0:I.map)==null?void 0:X.call(I,e=>t.createElement(d,{key:e._id,value:e._id,className:"menuItem"},e.name))),r.bank.invalid&&t.createElement(N,null,r.bank.message))),t.createElement("div",{className:"grid-item"},t.createElement(v,{fullWidth:!0,size:"small",error:r.bankAccountNumber.invalid},t.createElement(p,{id:"typeName"},"Bank account number"),t.createElement(C,{labelId:"typeName",name:"bankAccountNumber",label:"Bank account number",value:s.bankAccountNumber,onChange:g},(Z=B==null?void 0:B.map)==null?void 0:Z.call(B,e=>t.createElement(d,{key:e._id,value:e.accountNo,className:"menuItem"},e.accountNo))),r.bankAccountNumber.invalid&&t.createElement(N,null,r.bankAccountNumber.message)))),t.createElement("div",{className:"grid-item"},t.createElement(v,{fullWidth:!0,error:r.description.invalid},t.createElement(L,{size:"small",variant:"outlined",label:"Description",value:s.description,error:r.description.invalid,onChange:g,name:"description",id:"description"}),r.description.invalid&&t.createElement(N,null,r.description.message)))),t.createElement("div",{className:"right"},t.createElement(D,{variant:"outlined",size:"medium",onClick:ke},"Back"),t.createElement(D,{variant:"outlined",size:"medium",onClick:fe,className:"ml6"},"Reset"),t.createElement(D,{variant:"contained",size:"medium",type:"submit",color:"primary",className:"ml6"},"Save")))))};export{Ft as default};
