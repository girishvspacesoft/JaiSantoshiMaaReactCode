import{r as o,a as t}from"./react-69b9bddd.js";import{L as q,A as P,D as j}from"./x-date-pickers-f3802fc3.js";import"./Card.module-3bdbfb7f.js";import{ad as Q,ah as U,ai as G,L as J,aj as K,ak as X}from"./index-1d9d8716.js";import{T as Z,a as $}from"./TaxDetailList-a70f1c0f.js";import{a as ee,u as te}from"./react-redux-13959126.js";import{a as ae}from"./react-router-7dadf37a.js";import{O as ie,Q as re,a as le,i as u,A as z,h as d,V as f,l as N}from"./material-04052d9a.js";import"./@babel-5e587562.js";import"./@date-io-28dabb9c.js";import"./dayjs-39ab3f8d.js";import"./utils-49fe0532.js";import"./clsx-1229b3e0.js";import"./base-e8cfb5a9.js";import"./react-dom-69e96a05.js";import"./scheduler-765c72db.js";import"./@popperjs-f3391c26.js";import"./rifm-bf33b601.js";import"./system-49be6911.js";import"./styled-engine-f8044af8.js";import"./@emotion-17579717.js";import"./hoist-non-react-statics-1d21e5a8.js";import"./stylis-79144faa.js";import"./private-theming-ec89146b.js";import"./react-transition-group-deabed87.js";import"./dom-helpers-9a525042.js";import"./redux-persist-a379f351.js";import"./redux-fa075741.js";import"./@reduxjs-2459f64e.js";import"./immer-41fd5235.js";import"./redux-thunk-ef899f4c.js";import"./axios-21b846bc.js";import"./react-router-dom-38324838.js";import"./@remix-run-8989dd9f.js";import"./icons-material-40f8e5d8.js";import"./react-icons-6bc9af43.js";import"./use-sync-external-store-20ba4de3.js";const x={owner:{invalid:!1,message:""},vehicleType:{invalid:!1,message:""},vehicleNo:{invalid:!1,message:""},taxDetails:{invalid:!1,message:""}},qe=()=>{const v={owner:"",vehicleType:"",vehicleNo:"",make:"",capacity:"",regDate:null,chassisNo:"",engineNo:"",description:"",taxDetails:[]},[k,F]=o.useState([]),[A,L]=o.useState([]),[n,m]=o.useState(v),[s,T]=o.useState(x),[D,c]=o.useState(""),[g,b]=o.useState(null),E=ee(),C=ae(),S=te(Q),V=o.useCallback(()=>{C("/master/vehicles")},[C]);o.useEffect(()=>{E(U()).then(({payload:e={}})=>{const{message:a}=(e==null?void 0:e.data)||{};a?c(a):(c(""),L(e==null?void 0:e.data))}).catch(e=>{c(e.message)})},[]),o.useEffect(()=>{E(G()).then(({payload:e={}})=>{const{message:a}=(e==null?void 0:e.data)||{};a?c(a):(c(""),F(e==null?void 0:e.data))}).catch(e=>{c(e.message)})},[]);const W=()=>{m(v),c(""),T(x)},H=()=>{V()},p=e=>{const a=e.target.name,r=e.target.value;m(i=>({...i,[a]:r}))},Y=e=>{var i;const a=e.target.name,r=(i=e.target.value)==null?void 0:i.toUpperCase();m(l=>({...l,[a]:r}))},w=(e,a)=>{m(r=>({...r,[a]:e}))},y=(e,a)=>{m(r=>({...r,[e]:a}))},I=e=>{var a,r;e.preventDefault(),O(n)||E(X({...n,owner:(a=n.owner)==null?void 0:a._id,vehicleType:(r=n.vehicleType)==null?void 0:r._id})).then(({payload:i={}})=>{const{message:l}=(i==null?void 0:i.data)||{};l?c(l):(c(""),m(v),V())}).catch(i=>{c(i.message)})},O=e=>{var i,l;const a={...x};e.owner||(a.owner={invalid:!0,message:"Supplier is required"}),e.vehicleType||(a.vehicleType={invalid:!0,message:"Vehicle type is required"}),(l=(i=e.vehicleNo)==null?void 0:i.trim)!=null&&l.call(i)||(a.vehicleNo={invalid:!0,message:"Vehicle number is required"});let r=!1;for(const h in a)a[h].invalid===!0&&(r=!0);return r&&T(a),r},_=e=>{if(!g)m(a=>{var i,l;const r={...a};return(l=(i=r.taxDetails)==null?void 0:i.push)==null||l.call(i,e),r});else{const a={...g},r={...e};delete r.index,m(i=>{const l={...i},h=[...i.taxDetails];return h[a.index]={...r},l.taxDetails=[...h],l}),b(null)}},B=e=>{b({...n.taxDetails[e],index:e})},M=e=>{m(a=>{var i,l;const r={...a};return r.taxDetails=(l=(i=r.taxDetails)==null?void 0:i.filter)==null?void 0:l.call(i,(h,R)=>R!==e),r})};return t.createElement(t.Fragment,null,S&&t.createElement(J,null),t.createElement("h1",{className:"pageHead"},"Add a vehicle"),D!==""&&t.createElement(ie,{sx:{width:"100%",margin:"0 0 30px 0",border:"1px solid red",borderRadius:"4px"},spacing:2},t.createElement(re,{severity:"error"},D)),!S&&t.createElement("div",{className:"inner-wrap"},t.createElement("form",{action:"",id:"vehicleForm",onSubmit:I},t.createElement(le,{sx:{padding:"20px",marginBottom:"20px"}},t.createElement("div",{className:"grid grid-6-col"},t.createElement("div",{className:"grid-item"},t.createElement(u,{fullWidth:!0,size:"small",error:s.owner.invalid},t.createElement(z,{autoSelect:!0,size:"small",name:"owner",options:A,value:n.owner||null,onChange:(e,a)=>w(a,"owner"),openOnFocus:!0,getOptionLabel:e=>e.name,renderInput:e=>t.createElement(d,{...e,label:"Vehicle supplier",error:s.owner.invalid,fullWidth:!0})}),s.owner.invalid&&t.createElement(f,null,s.owner.message))),t.createElement("div",{className:"grid-item"},t.createElement(u,{fullWidth:!0,error:s.vehicleNo.invalid},t.createElement(d,{size:"small",variant:"outlined",label:"Vehicle number",value:n.vehicleNo,error:s.vehicleNo.invalid,onChange:Y,onInput:K,name:"vehicleNo",id:"vehicleNo"}),s.vehicleNo.invalid&&t.createElement(f,null,s.vehicleNo.message))),t.createElement("div",{className:"grid-item"},t.createElement(u,{fullWidth:!0,size:"small",error:s.vehicleType.invalid},t.createElement(z,{autoSelect:!0,size:"small",name:"vehicleType",options:k,value:n.vehicleType||null,onChange:(e,a)=>w(a,"vehicleType"),openOnFocus:!0,getOptionLabel:e=>e.type,renderInput:e=>t.createElement(d,{...e,label:"Vehicle type",error:s.vehicleType.invalid,fullWidth:!0})}),s.vehicleType.invalid&&t.createElement(f,null,s.vehicleType.message))),t.createElement("div",{className:"grid-item"},t.createElement(u,{fullWidth:!0},t.createElement(d,{size:"small",variant:"outlined",label:"Make",value:n.make,onChange:p,name:"make",id:"make"}))),t.createElement("div",{className:"grid-item"},t.createElement(u,{fullWidth:!0},t.createElement(d,{size:"small",variant:"outlined",label:"Capacity",value:n.capacity,onChange:p,name:"capacity",id:"capacity"}))),t.createElement("div",{className:"grid-item"},t.createElement(u,{fullWidth:!0,error:!0},t.createElement(q,{dateAdapter:P},t.createElement(j,{label:"Registration date",inputFormat:"DD/MM/YYYY",format:"DD/MM/YYYY",value:n.regDate,disableFuture:!0,onChange:y.bind(null,"regDate"),renderInput:e=>t.createElement(d,{name:"regDate",size:"small",...e})})))),t.createElement("div",{className:"grid-item"},t.createElement(u,{fullWidth:!0},t.createElement(d,{size:"small",variant:"outlined",label:"Chassis number",value:n.chassisNo,onChange:p,name:"chassisNo",id:"chassisNo"}))),t.createElement("div",{className:"grid-item"},t.createElement(u,{fullWidth:!0},t.createElement(d,{size:"small",variant:"outlined",label:"Engine number",value:n.engineNo,onChange:p,name:"engineNo",id:"engineNo"}))),t.createElement("div",{className:"grid-item"},t.createElement(u,{fullWidth:!0},t.createElement(d,{size:"small",variant:"outlined",label:"Description",value:n.description,onChange:p,name:"description",id:"description"})))))),t.createElement("div",{className:"bl_contact_person"},t.createElement("div",{className:"bl_form"},t.createElement(Z,{onTaxDetailAdd:_,editTaxDetail:g})),t.createElement("div",{className:"bl_content"},t.createElement($,{taxDetails:n.taxDetails,handleTriggerEdit:B,handleTriggerDelete:M}))),t.createElement("div",{className:"right"},t.createElement(N,{variant:"outlined",size:"medium",onClick:H},"Back"),t.createElement(N,{variant:"outlined",size:"medium",onClick:W,className:"ml6"},"Reset"),t.createElement(N,{variant:"contained",size:"medium",type:"submit",color:"primary",form:"vehicleForm",className:"ml6"},"Save"))))};export{qe as default};
