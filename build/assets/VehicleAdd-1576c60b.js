import{r as m,a as e}from"./react-bfabd40c.js";import{L as R,A as q,D as P}from"./x-date-pickers-7b1cc7dd.js";import"./Card.module-3bdbfb7f.js";import{ac as j,ag as Q,ah as G,L as J,ai as K}from"./index-54d20a5c.js";import{T as U,a as X}from"./TaxDetailList-cd7bfd1b.js";import{a as Z,u as $}from"./react-redux-45d870ba.js";import{a as ee}from"./react-router-622b2d59.js";import{O as te,Q as ae,a as ie,i as o,A as z,h as u,V as f,l as N}from"./material-e0a59a28.js";import"./@babel-e11bafe1.js";import"./@date-io-f382d426.js";import"./dayjs-7f45ce31.js";import"./utils-c03c978f.js";import"./clsx-1229b3e0.js";import"./base-ff50cfe3.js";import"./@popperjs-f3391c26.js";import"./react-dom-b0178e93.js";import"./scheduler-765c72db.js";import"./rifm-7b0f12ad.js";import"./system-a1d29c52.js";import"./styled-engine-f3bd09bf.js";import"./@emotion-77835cc8.js";import"./hoist-non-react-statics-6cfbf744.js";import"./stylis-79144faa.js";import"./private-theming-970ac73c.js";import"./react-transition-group-7ded6f4d.js";import"./dom-helpers-9a525042.js";import"./redux-persist-d9cc1560.js";import"./redux-b7ba668d.js";import"./@reduxjs-4d37e7cf.js";import"./immer-41fd5235.js";import"./redux-thunk-ef899f4c.js";import"./axios-4a70c6fc.js";import"./react-router-dom-60901e53.js";import"./@remix-run-d753ad9e.js";import"./icons-material-4539f19e.js";import"./react-icons-55b3b9a0.js";import"./use-sync-external-store-18921cc2.js";const x={owner:{invalid:!1,message:""},vehicleType:{invalid:!1,message:""},vehicleNo:{invalid:!1,message:""},taxDetails:{invalid:!1,message:""}},Me=()=>{const v={owner:"",vehicleType:"",vehicleNo:"",make:"",capacity:"",regDate:null,chassisNo:"",engineNo:"",description:"",taxDetails:[]},[k,F]=m.useState([]),[L,W]=m.useState([]),[l,d]=m.useState(v),[s,T]=m.useState(x),[D,c]=m.useState(""),[g,b]=m.useState(null),E=Z(),C=ee(),S=$(j),V=m.useCallback(()=>{C("/master/vehicles")},[C]);m.useEffect(()=>{E(Q()).then(({payload:t={}})=>{const{message:a}=(t==null?void 0:t.data)||{};a?c(a):(c(""),W(t==null?void 0:t.data))}).catch(t=>{c(t.message)})},[]),m.useEffect(()=>{E(G()).then(({payload:t={}})=>{const{message:a}=(t==null?void 0:t.data)||{};a?c(a):(c(""),F(t==null?void 0:t.data))}).catch(t=>{c(t.message)})},[]);const A=()=>{d(v),c(""),T(x)},H=()=>{V()},p=t=>{const a=t.target.name,r=t.target.value;d(i=>({...i,[a]:r}))},w=(t,a)=>{d(r=>({...r,[a]:t}))},Y=(t,a)=>{d(r=>({...r,[t]:a}))},y=t=>{var a,r;t.preventDefault(),O(l)||E(K({...l,owner:(a=l.owner)==null?void 0:a._id,vehicleType:(r=l.vehicleType)==null?void 0:r._id})).then(({payload:i={}})=>{const{message:n}=(i==null?void 0:i.data)||{};n?c(n):(c(""),d(v),V())}).catch(i=>{c(i.message)})},O=t=>{var i,n;const a={...x};t.owner||(a.owner={invalid:!0,message:"Supplier is required"}),t.vehicleType||(a.vehicleType={invalid:!0,message:"Vehicle type is required"}),(n=(i=t.vehicleNo)==null?void 0:i.trim)!=null&&n.call(i)||(a.vehicleNo={invalid:!0,message:"Vehicle number is required"});let r=!1;for(const h in a)a[h].invalid===!0&&(r=!0);return r&&T(a),r},_=t=>{if(!g)d(a=>{var i,n;const r={...a};return(n=(i=r.taxDetails)==null?void 0:i.push)==null||n.call(i,t),r});else{const a={...g},r={...t};delete r.index,d(i=>{const n={...i},h=[...i.taxDetails];return h[a.index]={...r},n.taxDetails=[...h],n}),b(null)}},B=t=>{b({...l.taxDetails[t],index:t})},I=t=>{d(a=>{var i,n;const r={...a};return r.taxDetails=(n=(i=r.taxDetails)==null?void 0:i.filter)==null?void 0:n.call(i,(h,M)=>M!==t),r})};return e.createElement(e.Fragment,null,S&&e.createElement(J,null),e.createElement("h1",{className:"pageHead"},"Add a vehicle"),D!==""&&e.createElement(te,{sx:{width:"100%",margin:"0 0 30px 0",border:"1px solid red",borderRadius:"4px"},spacing:2},e.createElement(ae,{severity:"error"},D)),!S&&e.createElement("div",{className:"inner-wrap"},e.createElement("form",{action:"",id:"vehicleForm",onSubmit:y},e.createElement(ie,{sx:{padding:"20px",marginBottom:"20px"}},e.createElement("div",{className:"grid grid-6-col"},e.createElement("div",{className:"grid-item"},e.createElement(o,{fullWidth:!0,size:"small",error:s.owner.invalid},e.createElement(z,{autoSelect:!0,size:"small",name:"owner",options:L,value:l.owner||null,onChange:(t,a)=>w(a,"owner"),openOnFocus:!0,getOptionLabel:t=>t.name,renderInput:t=>e.createElement(u,{...t,label:"Vehicle supplier",error:s.owner.invalid,fullWidth:!0})}),s.owner.invalid&&e.createElement(f,null,s.owner.message))),e.createElement("div",{className:"grid-item"},e.createElement(o,{fullWidth:!0,error:s.vehicleNo.invalid},e.createElement(u,{size:"small",variant:"outlined",label:"Vehicle number",value:l.vehicleNo,error:s.vehicleNo.invalid,onChange:p,name:"vehicleNo",id:"vehicleNo"}),s.vehicleNo.invalid&&e.createElement(f,null,s.vehicleNo.message))),e.createElement("div",{className:"grid-item"},e.createElement(o,{fullWidth:!0,size:"small",error:s.vehicleType.invalid},e.createElement(z,{autoSelect:!0,size:"small",name:"vehicleType",options:k,value:l.vehicleType||null,onChange:(t,a)=>w(a,"vehicleType"),openOnFocus:!0,getOptionLabel:t=>t.type,renderInput:t=>e.createElement(u,{...t,label:"Vehicle type",error:s.vehicleType.invalid,fullWidth:!0})}),s.vehicleType.invalid&&e.createElement(f,null,s.vehicleType.message))),e.createElement("div",{className:"grid-item"},e.createElement(o,{fullWidth:!0},e.createElement(u,{size:"small",variant:"outlined",label:"Make",value:l.make,onChange:p,name:"make",id:"make"}))),e.createElement("div",{className:"grid-item"},e.createElement(o,{fullWidth:!0},e.createElement(u,{size:"small",variant:"outlined",label:"Capacity",value:l.capacity,onChange:p,name:"capacity",id:"capacity"}))),e.createElement("div",{className:"grid-item"},e.createElement(o,{fullWidth:!0,error:!0},e.createElement(R,{dateAdapter:q},e.createElement(P,{label:"Registration date",inputFormat:"DD/MM/YYYY",format:"DD/MM/YYYY",value:l.regDate,disableFuture:!0,onChange:Y.bind(null,"regDate"),renderInput:t=>e.createElement(u,{name:"regDate",size:"small",...t})})))),e.createElement("div",{className:"grid-item"},e.createElement(o,{fullWidth:!0},e.createElement(u,{size:"small",variant:"outlined",label:"Chassis number",value:l.chassisNo,onChange:p,name:"chassisNo",id:"chassisNo"}))),e.createElement("div",{className:"grid-item"},e.createElement(o,{fullWidth:!0},e.createElement(u,{size:"small",variant:"outlined",label:"Engine number",value:l.engineNo,onChange:p,name:"engineNo",id:"engineNo"}))),e.createElement("div",{className:"grid-item"},e.createElement(o,{fullWidth:!0},e.createElement(u,{size:"small",variant:"outlined",label:"Description",value:l.description,onChange:p,name:"description",id:"description"})))))),e.createElement("div",{className:"bl_contact_person"},e.createElement("div",{className:"bl_form"},e.createElement(U,{onTaxDetailAdd:_,editTaxDetail:g})),e.createElement("div",{className:"bl_content"},e.createElement(X,{taxDetails:l.taxDetails,handleTriggerEdit:B,handleTriggerDelete:I}))),e.createElement("div",{className:"right"},e.createElement(N,{variant:"outlined",size:"medium",onClick:H},"Back"),e.createElement(N,{variant:"outlined",size:"medium",onClick:A,className:"ml6"},"Reset"),e.createElement(N,{variant:"contained",size:"medium",type:"submit",color:"primary",form:"vehicleForm",className:"ml6"},"Save"))))};export{Me as default};
