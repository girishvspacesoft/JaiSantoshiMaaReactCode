import{r as p,a as e}from"./react-bfabd40c.js";import{u as A,a as Z}from"./react-redux-45d870ba.js";import{f as G}from"./icons-material-4539f19e.js";import{L as C,A as F,D as x}from"./x-date-pickers-7b1cc7dd.js";import"./Card.module-3bdbfb7f.js";import{cR as J,cY as K,L as U,cZ as X}from"./index-60b53c60.js";import{S as $}from"./Stations-c63cb442.js";import{b as y,a as ee}from"./react-router-1b5f20a2.js";import{O as te,Q as ae,a as re,i as d,h as u,V as v,D as L,a5 as ie,a6 as ne,a7 as le,a8 as I,a9 as o,aa as se,f as oe,l as R}from"./material-e0a59a28.js";import"./@babel-e11bafe1.js";import"./react-dom-b0178e93.js";import"./scheduler-765c72db.js";import"./hoist-non-react-statics-6cfbf744.js";import"./use-sync-external-store-18921cc2.js";import"./@date-io-f382d426.js";import"./dayjs-7f45ce31.js";import"./utils-c03c978f.js";import"./clsx-1229b3e0.js";import"./base-ff50cfe3.js";import"./@popperjs-f3391c26.js";import"./rifm-7b0f12ad.js";import"./system-a1d29c52.js";import"./styled-engine-f3bd09bf.js";import"./@emotion-77835cc8.js";import"./stylis-79144faa.js";import"./private-theming-970ac73c.js";import"./react-transition-group-7ded6f4d.js";import"./dom-helpers-9a525042.js";import"./redux-persist-d9cc1560.js";import"./redux-b7ba668d.js";import"./@reduxjs-4d37e7cf.js";import"./immer-41fd5235.js";import"./redux-thunk-ef899f4c.js";import"./axios-4a70c6fc.js";import"./react-router-dom-4405dfe9.js";import"./@remix-run-d753ad9e.js";import"./react-icons-55b3b9a0.js";const B={date:new Date,customer:"",from:null,to:null,otherField:"",ratePer:"",stations:[]},P={date:{invalid:!1,message:""},customer:{invalid:!1,message:""},from:{invalid:!1,message:""},to:{invalid:!1,message:""},ratePer:{invalid:!1,message:""},stations:{invalid:!1,message:""}},Ze=()=>{var T,f,k;const M=A(J),Q=y(),{quotationId:D}=Q.state,[i,m]=p.useState(B),[r,N]=p.useState(P),[q,g]=p.useState(""),z=Z(),Y=ee(),{places:E}=A(({quotation:t})=>t)||{},S=p.useCallback(()=>{Y("/transactions/quotations")},[Y]);p.useEffect(()=>{E!=null&&E.length&&D&&z(K(D)).then(({payload:t={}})=>{const{message:a}=(t==null?void 0:t.data)||{};a?g(a):m(t==null?void 0:t.data)}).catch(()=>{g("Something went wrong! Please try later or contact Administrator.")})},[E]);const W=()=>{S()},h=t=>{const a=t.target.name,n=t.target.value;m(l=>({...l,[a]:n}))},j=t=>{t.preventDefault(),O(i)||z(X(i)).then(({payload:a={}})=>{const{message:n}=(a==null?void 0:a.data)||{};n?g(n):(g(""),N(P),m(B),S())}).catch(a=>{g(a.message)})},O=t=>{var l,s,c,H,w;const a={...P};t.date||(a.date={invalid:!0,message:"Date is required"}),(s=(l=t.customer)==null?void 0:l.trim)!=null&&s.call(l)||(a.customer={invalid:!0,message:"Customer is required"}),t.from||(a.from={invalid:!0,message:"From date is required"}),t.to||(a.to={invalid:!0,message:"To date is required"}),(H=(c=t.ratePer)==null?void 0:c.trim)!=null&&H.call(c)||(a.ratePer={invalid:!0,message:"Rate type is required"}),(w=t.stations)!=null&&w.length||(a.stations={invalid:!0,message:"At least one entry is required"});let n=!1;for(const _ in a)a[_].invalid===!0&&(n=!0);return n&&N(a),n},b=(t,a)=>{m(n=>({...n,[t]:new Date(a)}))},V=(t,a)=>{var n,l;if(t.preventDefault(),(n=i.stations)!=null&&n.length){const s=i.stations;(l=s==null?void 0:s.splice)==null||l.call(s,a,1),m(c=>({...c,stations:s}))}};return e.createElement(e.Fragment,null,M&&e.createElement(U,null),e.createElement("h1",{className:"pageHead"},"Edit a quotation"),e.createElement("div",{className:"inner-wrap"},q!==""&&e.createElement(te,{sx:{width:"100%",margin:"0 0 30px 0",border:"1px solid red",borderRadius:"4px"},spacing:2},e.createElement(ae,{severity:"error"},q)),e.createElement(re,{sx:{padding:"20px",marginBottom:"20px"}},e.createElement("form",{action:"",onSubmit:j,id:"quotationForm"},e.createElement("div",{className:"grid grid-6-col"},e.createElement("div",{className:"grid-item"},e.createElement(d,{fullWidth:!0,error:r.date.invalid},e.createElement(C,{dateAdapter:F},e.createElement(x,{error:r.date.invalid,label:"Date",inputFormat:"DD/MM/YYYY",value:i.date,onChange:b.bind(null,"date"),renderInput:t=>e.createElement(u,{name:"date",size:"small",autoComplete:"off",...t,error:r.date.invalid})})),r.date.invalid&&e.createElement(v,null,r.date.message))),e.createElement("div",{className:"grid-item"},e.createElement(d,{fullWidth:!0,size:"small",error:r.customer.invalid},e.createElement(u,{size:"small",variant:"outlined",label:"Customer",value:i.customer,error:r.customer.invalid,onChange:h,name:"customer",id:"customer"}),r.customer.invalid&&e.createElement(v,null,r.customer.message))),e.createElement("div",{className:"grid-item"},e.createElement(d,{fullWidth:!0,error:r.from.invalid},e.createElement(C,{dateAdapter:F},e.createElement(x,{error:r.from.invalid,label:"From date",inputFormat:"DD/MM/YYYY",value:i.from,onChange:b.bind(null,"from"),renderInput:t=>e.createElement(u,{name:"from",size:"small",autoComplete:"off",...t,error:r.from.invalid})})),r.from.invalid&&e.createElement(v,null,r.from.message))),e.createElement("div",{className:"grid-item"},e.createElement(d,{fullWidth:!0,error:r.to.invalid},e.createElement(C,{dateAdapter:F},e.createElement(x,{error:r.to.invalid,label:"To date",inputFormat:"DD/MM/YYYY",value:i.to,onChange:b.bind(null,"to"),renderInput:t=>e.createElement(u,{name:"to",size:"small",autoComplete:"off",...t,error:r.to.invalid})})),r.to.invalid&&e.createElement(v,null,r.to.message))),e.createElement("div",{className:"grid-item"},e.createElement(d,{fullWidth:!0,size:"small",error:r.ratePer.invalid},e.createElement(u,{size:"small",variant:"outlined",label:"Rate per",value:i.ratePer,error:r.ratePer.invalid,onChange:h,name:"ratePer",id:"ratePer"}),r.ratePer.invalid&&e.createElement(v,null,r.ratePer.message))),e.createElement("div",{className:"grid-item"},e.createElement(d,{fullWidth:!0,size:"small"},e.createElement(u,{size:"small",variant:"outlined",label:"Other header field",value:i.otherField,onChange:h,name:"otherField",id:"otherField"}))))),e.createElement(L,{sx:{margin:"20px 0"}}),r.stations.invalid&&e.createElement("p",{className:"error"},r.stations.message),e.createElement($,{places:E,quotation:i,setQuotation:m}),((T=i.stations)==null?void 0:T.length)>0?e.createElement(ie,null,e.createElement(ne,{sx:{width:500},className:"tbl_jsm"},e.createElement(le,null,e.createElement(I,null,e.createElement(o,null,"Station"),e.createElement(o,{align:"right"},"Rate per ",i.ratePer),e.createElement(o,{align:"right"},i.otherField),e.createElement(o,{align:"right"}," "))),e.createElement(se,null,(k=(f=i.stations)==null?void 0:f.map)==null?void 0:k.call(f,(t,a)=>e.createElement(I,{key:a,sx:{"&:last-child td, &:last-child th":{border:0}}},e.createElement(o,null,t.station),e.createElement(o,{align:"right"},"₹ ",t.amount),e.createElement(o,{align:"right"},"₹ ",t.otherFieldValue),e.createElement(o,null,e.createElement(oe,{size:"small",onClick:n=>V(n,a),color:"error"},e.createElement(G,null)))))))):null,e.createElement(L,{sx:{margin:"20px 0"}}),e.createElement("div",{className:"right"},e.createElement(R,{variant:"outlined",size:"medium",onClick:W},"Back"),e.createElement(R,{variant:"contained",size:"medium",type:"submit",color:"primary",form:"quotationForm",className:"ml6"},"Save")))))};export{Ze as default};
