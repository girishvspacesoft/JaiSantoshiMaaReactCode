import{r as u,a as e}from"./react-69b9bddd.js";import{d as U}from"./dayjs-39ab3f8d.js";import{L as G,A as J,D as K}from"./x-date-pickers-f3802fc3.js";import"./Card.module-3bdbfb7f.js";import{ad as X,al as Z,ah as $,ai as ee,L as te,aj as ae,am as ie}from"./index-1d9d8716.js";import{T as re,a as ne}from"./TaxDetailList-a70f1c0f.js";import{u as L,a as le}from"./react-redux-13959126.js";import{a as se,b as oe}from"./react-router-7dadf37a.js";import{O as me,Q as ce,a as de,i as v,A as H,h as p,V as b,l as T}from"./material-04052d9a.js";import"./@babel-5e587562.js";import"./@date-io-28dabb9c.js";import"./utils-49fe0532.js";import"./clsx-1229b3e0.js";import"./base-e8cfb5a9.js";import"./react-dom-69e96a05.js";import"./scheduler-765c72db.js";import"./@popperjs-f3391c26.js";import"./rifm-bf33b601.js";import"./system-49be6911.js";import"./styled-engine-f8044af8.js";import"./@emotion-17579717.js";import"./hoist-non-react-statics-1d21e5a8.js";import"./stylis-79144faa.js";import"./private-theming-ec89146b.js";import"./react-transition-group-deabed87.js";import"./dom-helpers-9a525042.js";import"./redux-persist-a379f351.js";import"./redux-fa075741.js";import"./@reduxjs-2459f64e.js";import"./immer-41fd5235.js";import"./redux-thunk-ef899f4c.js";import"./axios-21b846bc.js";import"./react-router-dom-38324838.js";import"./@remix-run-8989dd9f.js";import"./icons-material-40f8e5d8.js";import"./react-icons-6bc9af43.js";import"./use-sync-external-store-20ba4de3.js";const C={owner:"",vehicleType:"",vehicleNo:"",make:"",capacity:"",regDate:null,chassisNo:"",engineNo:"",description:"",taxDetails:[]},w={owner:{invalid:!1,message:""},vehicleType:{invalid:!1,message:""},vehicleNo:{invalid:!1,message:""},taxDetails:{invalid:!1,message:""}},Je=()=>{const{suppliers:o,vehicleTypes:m}=L(({vehicle:t})=>t),[n,d]=u.useState(C),[s,Y]=u.useState(C),[c,z]=u.useState(w),[F,h]=u.useState(""),[D,S]=u.useState(null),k=L(X),f=le(),V=se(),I=oe(),{vehicleId:x}=I.state,W=u.useCallback(()=>{V("/master/vehicles")},[V]);u.useEffect(()=>{var t,a;d({...s,owner:(t=o==null?void 0:o.find)==null?void 0:t.call(o,({_id:i})=>(s==null?void 0:s.owner)===i),vehicleType:(a=m==null?void 0:m.find)==null?void 0:a.call(m,({_id:i})=>(s==null?void 0:s.vehicleType)===i)})},[o,s,m]),u.useEffect(()=>{x&&f(Z(x)).then(({payload:t={}})=>{const{message:a,regDate:i}=(t==null?void 0:t.data)||{};a?h(a):(i&&(t.data.regDate=U(i)),d(t==null?void 0:t.data),Y(t==null?void 0:t.data))}).catch(t=>{h(t.message)})},[x]),u.useEffect(()=>{f($())},[]),u.useEffect(()=>{f(ee())},[]);const _=()=>{var t,a;d({...s,owner:(t=o==null?void 0:o.find)==null?void 0:t.call(o,({_id:i})=>(s==null?void 0:s.owner)===i),vehicleType:(a=m==null?void 0:m.find)==null?void 0:a.call(m,({_id:i})=>(s==null?void 0:s.vehicleType)===i)}),h(""),z(w)},y=()=>{W()},E=t=>{const a=t.target.name,i=t.target.value;d(r=>({...r,[a]:i}))},B=t=>{var r;const a=t.target.name,i=(r=t.target.value)==null?void 0:r.toUpperCase();d(l=>({...l,[a]:i}))},A=(t,a)=>{d(i=>({...i,[a]:t}))},M=(t,a)=>{d(i=>({...i,[t]:a}))},P=t=>{var a,i;t.preventDefault(),R(n)||f(ie({...n,owner:(a=n==null?void 0:n.owner)==null?void 0:a._id,vehicleType:(i=n==null?void 0:n.vehicleType)==null?void 0:i._id})).then(({payload:r={}})=>{const{message:l}=(r==null?void 0:r.data)||{};l?h(l):(h(""),d(C),W())}).catch(r=>{h(r.message)})},R=t=>{var r,l,g,N;const a={...w};(r=t.owner)!=null&&r.label||(a.owner={invalid:!0,message:"Supplier is required"}),(l=t.vehicleType)!=null&&l.label||(a.vehicleType={invalid:!0,message:"Vehicle type is required"}),(N=(g=t.vehicleNo)==null?void 0:g.trim)!=null&&N.call(g)||(a.vehicleNo={invalid:!0,message:"Vehicle number is required"});let i=!1;for(const Q in a)a[Q].invalid===!0&&(i=!0);return i&&z(a),i},O=t=>{if(!D)d(a=>{var r,l;const i={...a};return(l=(r=i.taxDetails)==null?void 0:r.push)==null||l.call(r,t),i});else{const a={...D},i={...t};delete i.index,d(r=>{const l={...r},g=[...r.taxDetails];return g[a.index]={...i},l.taxDetails=[...g],l}),S(null)}},j=t=>{S({...n.taxDetails[t],index:t})},q=t=>{d(a=>{var r,l;const i={...a};return i.taxDetails=(l=(r=i.taxDetails)==null?void 0:r.filter)==null?void 0:l.call(r,(g,N)=>N!==t),i})};return e.createElement(e.Fragment,null,k&&e.createElement(te,null),e.createElement("h1",{className:"pageHead"},"Edit a vehicle"),F!==""&&e.createElement(me,{sx:{width:"100%",margin:"0 0 30px 0",border:"1px solid red",borderRadius:"4px"},spacing:2},e.createElement(ce,{severity:"error"},F)),!k&&e.createElement("div",null,e.createElement("form",{action:"",id:"customerForm",onSubmit:P},e.createElement(de,{sx:{padding:"20px",marginBottom:"20px"}},e.createElement("div",{className:"grid grid-6-col"},e.createElement("div",{className:"grid-item"},e.createElement(v,{fullWidth:!0,size:"small",error:c.owner.invalid},e.createElement(H,{disablePortal:!0,autoSelect:!0,size:"small",name:"owner",options:o,value:(n==null?void 0:n.owner)||"",onChange:(t,a)=>A(a,"owner"),openOnFocus:!0,renderInput:t=>e.createElement(p,{...t,label:"Vehicle supplier",error:c.owner.invalid,fullWidth:!0})}),c.owner.invalid&&e.createElement(b,null,c.owner.message))),e.createElement("div",{className:"grid-item"},e.createElement(v,{fullWidth:!0,error:c.vehicleNo.invalid},e.createElement(p,{size:"small",variant:"outlined",label:"Vehicle number",value:n.vehicleNo,error:c.vehicleNo.invalid,onChange:B,onInput:ae,name:"vehicleNo",id:"vehicleNo"}),c.vehicleNo.invalid&&e.createElement(b,null,c.vehicleNo.message))),e.createElement("div",{className:"grid-item"},e.createElement(v,{fullWidth:!0,size:"small",error:c.vehicleType.invalid},e.createElement(H,{disablePortal:!0,size:"small",name:"vehicleType",options:m,value:n.vehicleType||"",onChange:(t,a)=>A(a,"vehicleType"),openOnFocus:!0,renderInput:t=>e.createElement(p,{...t,label:"Vehicle type",error:c.vehicleType.invalid,fullWidth:!0})}),c.vehicleType.invalid&&e.createElement(b,null,c.vehicleType.message))),e.createElement("div",{className:"grid-item"},e.createElement(v,{fullWidth:!0},e.createElement(p,{size:"small",variant:"outlined",label:"Make",value:n.make,onChange:E,name:"make",id:"make"}))),e.createElement("div",{className:"grid-item"},e.createElement(v,{fullWidth:!0},e.createElement(p,{size:"small",variant:"outlined",label:"Capacity",value:n.capacity,onChange:E,name:"capacity",id:"capacity"}))),e.createElement("div",{className:"grid-item"},e.createElement(v,{fullWidth:!0,error:!0},e.createElement(G,{dateAdapter:J},e.createElement(K,{label:"Registration date",inputFormat:"DD/MM/YYYY",format:"DD/MM/YYYY",value:n.regDate,disableFuture:!0,onChange:M.bind(null,"regDate"),renderInput:t=>e.createElement(p,{name:"regDate",size:"small",...t})})))),e.createElement("div",{className:"grid-item"},e.createElement(v,{fullWidth:!0},e.createElement(p,{size:"small",variant:"outlined",label:"Chassis number",value:n.chassisNo,onChange:E,name:"chassisNo",id:"chassisNo"}))),e.createElement("div",{className:"grid-item"},e.createElement(v,{fullWidth:!0},e.createElement(p,{size:"small",variant:"outlined",label:"Engine number",value:n.engineNo,onChange:E,name:"engineNo",id:"engineNo"}))),e.createElement("div",{className:"grid-item"},e.createElement(v,{fullWidth:!0},e.createElement(p,{size:"small",variant:"outlined",label:"Description",value:n.description,onChange:E,name:"description",id:"description"})))))),e.createElement("div",{className:"bl_contact_person"},e.createElement("div",{className:"bl_form"},e.createElement(re,{onTaxDetailAdd:O,editTaxDetail:D})),e.createElement("div",{className:"bl_content"},e.createElement(ne,{taxDetails:n.taxDetails,handleTriggerEdit:j,handleTriggerDelete:q}))),e.createElement("div",{className:"right"},e.createElement(T,{variant:"outlined",size:"medium",onClick:y},"Back"),e.createElement(T,{variant:"outlined",size:"medium",onClick:_,className:"ml6"},"Reset"),e.createElement(T,{variant:"contained",size:"medium",type:"submit",color:"primary",form:"customerForm",className:"ml6"},"Save"))))};export{Je as default};
