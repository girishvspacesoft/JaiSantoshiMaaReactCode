import{r as s,a as t}from"./react-69b9bddd.js";import{u as _,a as U}from"./react-redux-13959126.js";import{h as X}from"./icons-material-40f8e5d8.js";import{L as A,A as w,D as O}from"./x-date-pickers-f3802fc3.js";import{d3 as Z,d4 as $,d5 as y,d6 as ee,L as te,k as re,d7 as ne,ba as ie}from"./index-1d9d8716.js";import"./Card.module-3bdbfb7f.js";import{F as ae}from"./file-saver-259f058c.js";import{i as p,A as B,h as E,O as oe,Q as se,a as I,l as b}from"./material-04052d9a.js";import{G as h}from"./@material-ui-d7516ac8.js";import{D as me}from"./x-data-grid-83fc2422.js";import"./@babel-5e587562.js";import"./react-dom-69e96a05.js";import"./scheduler-765c72db.js";import"./hoist-non-react-statics-1d21e5a8.js";import"./use-sync-external-store-20ba4de3.js";import"./@date-io-28dabb9c.js";import"./dayjs-39ab3f8d.js";import"./utils-49fe0532.js";import"./clsx-1229b3e0.js";import"./base-e8cfb5a9.js";import"./@popperjs-f3391c26.js";import"./rifm-bf33b601.js";import"./system-49be6911.js";import"./styled-engine-f8044af8.js";import"./@emotion-17579717.js";import"./stylis-79144faa.js";import"./private-theming-ec89146b.js";import"./react-transition-group-deabed87.js";import"./dom-helpers-9a525042.js";import"./redux-persist-a379f351.js";import"./redux-fa075741.js";import"./@reduxjs-2459f64e.js";import"./immer-41fd5235.js";import"./redux-thunk-ef899f4c.js";import"./axios-21b846bc.js";import"./react-router-7dadf37a.js";import"./@remix-run-8989dd9f.js";import"./react-router-dom-38324838.js";import"./react-icons-6bc9af43.js";import"./jss-299ee23a.js";import"./is-in-browser-9e40da8a.js";import"./jss-plugin-rule-value-function-60587a41.js";import"./jss-plugin-global-c6030a8c.js";import"./jss-plugin-nested-fb36a984.js";import"./jss-plugin-camel-case-92f9f32c.js";import"./hyphenate-style-name-80972348.js";import"./jss-plugin-default-unit-2cb1c9e9.js";import"./jss-plugin-vendor-prefixer-24b01907.js";import"./css-vendor-1e7d08f8.js";import"./jss-plugin-props-sort-0c9fca2f.js";import"./prop-types-b6d0a120.js";import"./reselect-36a88051.js";const S={from:null,to:null,lrNo:"",consignor:null},st=()=>{var F;const C=[{field:"_id",headerName:"Id"},{field:"srNo",headerName:"Sr No.",minWidth:80,flex:1},{field:"formattedLSNo",headerName:"Challan No",flex:1,minWidth:80},{field:"generatedFrom",headerName:"Challan Generated From",flex:1,minWidth:100},{field:"date",headerName:"Date",minWidth:100,flex:1},{field:"vehicleNo",headerName:"Vehicle no",minWidth:100,flex:1},{field:"from",headerName:"From",minWidth:120,flex:1},{field:"to",headerName:"To",minWidth:120,flex:1},{field:"total",headerName:"Total Amount",minWidth:100,flex:1},{field:"lrNo",headerName:"LR No",minWidth:100,flex:1},{field:"consignorName",headerName:"Consignor",minWidth:150,flex:1},{field:"consigneeName",headerName:"Consignee",minWidth:150,flex:1},{field:"noOfArticle",headerName:"No. of Article",minWidth:90,flex:1},{field:"totalWeight",headerName:"Weight",minWidth:90,flex:1},{field:"payType",headerName:"Status",minWidth:90,flex:1}],P=_(Z),d=U(),f=_(e=>e.user),[R,H]=s.useState([]),[M,Y]=s.useState([]),[v,o]=s.useState(""),[m,W]=s.useState(null),[a,g]=s.useState(S),[z,u]=s.useState(!1),[l,k]=s.useState({page:0,pageSize:100}),[N,T]=s.useState({isLoading:!1,data:[],total:0});s.useEffect(()=>{d($()).then(({payload:e={}})=>{var n,i;const{message:r}=(e==null?void 0:e.data)||{};if(r)o(r);else if(o(""),H(e==null?void 0:e.data),f&&f.branch){const c=(i=(n=e==null?void 0:e.data)==null?void 0:n.find)==null?void 0:i.call(n,x=>x._id===f.branch);W(c)}}).catch(e=>{o(e.message)}),L("")},[]),s.useEffect(()=>{if(z&&(f.branch&&m||!f.branch)){const e={};m&&m._id&&(e.branch=m._id),a.from&&(e.from=a.from),a.to&&(e.to=a.to),a.lrNo&&(e.lrNo=a.lrNo),a.consignor&&(e.consignor=a.consignor._id);const r={pagination:{limit:l.pageSize?l.pageSize:100,page:l.page+1},query:e};d(y(r)).then(({payload:n={}})=>{const{message:i}=(n==null?void 0:n.data)||{};i?o(i):T(c=>({...c,isLoading:!1,data:(n==null?void 0:n.data.loadingSlips)||[],total:n==null?void 0:n.data.count})),u(!1)}).catch(n=>{u(!1),o(n.message)})}},[l.page,l.pageSize,m,z,d,a.from,a.lrNo,a.to]);const L=e=>{var n;const r=(n=e.trim)==null?void 0:n.call(e);((r==null?void 0:r.length)>2||!r)&&d(ee(r)).then(({payload:i={}})=>{const{message:c}=(i==null?void 0:i.data)||{};c?o(c):(o(""),Y(i==null?void 0:i.data))}).catch(i=>{o(i.message)})},j=({target:e})=>{L(e.value)},q=e=>{e.preventDefault();const r={isPrint:!0};m&&m._id&&(r.branch=m._id),a.from&&(r.from=a.from),a.to&&(r.to=a.to),a.lrNo&&(r.lrNo=a.lrNo),a.consignor&&(r.consignor=a.consignor._id);const n={pagination:{limit:l.pageSize?l.pageSize:100,page:l.page+1},query:r};d(ne(n)).then(({payload:i={}})=>{const{message:c}=(i==null?void 0:i.data)||{};if(c)o(c);else{const x=new Blob([i==null?void 0:i.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});ae.saveAs(x,"ChallanStatus.xlsx")}}).catch(i=>{o(i.message)})},G=(e,r,n)=>{g(i=>({...i,[n]:r}))},V=(e,r)=>{W(r),u(!1),g(S),d(ie(r._id))},Q=e=>{e.preventDefault(),u(!0)},D=(e,r)=>{g(n=>({...n,[e]:new Date(r)}))},J=e=>{e.preventDefault(),g(S),u(!0)},K=e=>{const r=e.target.name,n=e.target.value;g(i=>({...i,[r]:n}))};return t.createElement(t.Fragment,null,P&&t.createElement(te,null),t.createElement("div",{className:"inner-wrap"},t.createElement("div",{className:"page_head-1",style:{display:"flex",justifyContent:"space-between"}},t.createElement("h1",{className:"pageHead"},"Challan Note Register"),t.createElement("div",{className:""},t.createElement(p,{size:"small",sx:{width:"230px",marginRight:"5px",marginBottom:"20px"}},t.createElement(B,{disablePortal:!0,size:"small",name:"branch",options:R,value:m||null,onChange:V,disabled:!re(),getOptionLabel:e=>e.name,openOnFocus:!0,renderInput:e=>t.createElement(E,{...e,label:"Select branch",fullWidth:!0})})))),v!==""&&t.createElement(oe,{sx:{width:"100%",margin:"0 0 30px 0",border:"1px solid red",borderRadius:"4px"},spacing:2},t.createElement(se,{severity:"error"},v)),t.createElement(I,{sx:{padding:"20px",marginBottom:"20px"}},t.createElement("h2",{className:"mb20"},"Search"),t.createElement("form",{action:"",onSubmit:Q},t.createElement(h,{container:!0,spacing:3},t.createElement(h,{item:!0,xs:2},t.createElement(p,{fullWidth:!0},t.createElement(A,{dateAdapter:w},t.createElement(O,{label:"From",inputFormat:"DD/MM/YYYY",value:a.from,onChange:D.bind(null,"from"),renderInput:e=>t.createElement(E,{name:"from",size:"small",...e})})))),t.createElement(h,{item:!0,xs:2},t.createElement(p,{fullWidth:!0},t.createElement(A,{dateAdapter:w},t.createElement(O,{label:"To",inputFormat:"DD/MM/YYYY",value:a.to,onChange:D.bind(null,"to"),renderInput:e=>t.createElement(E,{name:"to",size:"small",...e})})))),t.createElement(h,{item:!0,xs:3},t.createElement(p,{fullWidth:!0,size:"small"},t.createElement(B,{disablePortal:!0,autoSelect:!0,autoHighlight:!0,size:"small",name:"consignor",options:M,value:a.consignor,onChange:(e,r)=>G(e,r,"consignor"),openOnFocus:!0,getOptionLabel:e=>e.name,renderInput:e=>t.createElement(E,{...e,label:"Customer",fullWidth:!0,onChange:r=>j(r)})}))),t.createElement(h,{item:!0,xs:2},t.createElement(p,{fullWidth:!0},t.createElement(E,{size:"small",variant:"outlined",label:"Lorry receipt no.",value:a.lrNo,onChange:K,name:"lrNo",id:"lrNo",inputProps:{maxLength:50}}))),t.createElement(h,{style:{display:"flex"},item:!0,xs:2},t.createElement(b,{type:"submit",variant:"contained",size:"medium",color:"primary"},"Search"),t.createElement(b,{type:"button",variant:"outlined",size:"medium",className:"ml6",onClick:e=>J(e)},"Reset"))))),t.createElement(I,{sx:{width:"100%"}},((F=N.data)==null?void 0:F.length)>0?t.createElement("div",{className:"tbl_header"},t.createElement(b,{variant:"contained",endIcon:t.createElement(X,null),onClick:q},"Export To Excel")):null,t.createElement(me,{autoHeight:!0,density:"compact",rows:N.data,rowCount:N.total,loading:N.isLoading,pageSizeOptions:[100],paginationModel:l,onPaginationModelChange:e=>{k(e),u(!0)},paginationMode:"server",columns:C,getRowId:e=>e._id,sx:{backgroundColor:"primary.contrastText"},initialState:{...C,columns:{columnVisibilityModel:{_id:!1}}},disableSelectionOnClick:!0}))))};export{st as default};
