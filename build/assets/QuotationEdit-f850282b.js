import{r as f,a as e}from"./react-bfabd40c.js";import{u as W,a as G}from"./react-redux-45d870ba.js";import{f as J}from"./icons-material-4539f19e.js";import{L as b,A as x,D as F}from"./x-date-pickers-7b1cc7dd.js";import"./Card.module-3bdbfb7f.js";import{d6 as K,dd as U,L as X,al as Z,de as $}from"./index-66f971e4.js";import{S as y}from"./Stations-f720caf4.js";import{b as ee,a as te}from"./react-router-622b2d59.js";import{O as ae,Q as re,a as le,i as n,h as s,V as v,m as ie,D as I,a5 as ne,a6 as se,a7 as me,a8 as k,a9 as c,aa as oe,f as de,l as w}from"./material-e0a59a28.js";import"./@babel-e11bafe1.js";import"./react-dom-b0178e93.js";import"./scheduler-765c72db.js";import"./hoist-non-react-statics-6cfbf744.js";import"./use-sync-external-store-18921cc2.js";import"./@date-io-f382d426.js";import"./dayjs-7f45ce31.js";import"./utils-c03c978f.js";import"./clsx-1229b3e0.js";import"./base-ff50cfe3.js";import"./@popperjs-f3391c26.js";import"./rifm-7b0f12ad.js";import"./system-a1d29c52.js";import"./styled-engine-f3bd09bf.js";import"./@emotion-77835cc8.js";import"./stylis-79144faa.js";import"./private-theming-970ac73c.js";import"./react-transition-group-7ded6f4d.js";import"./dom-helpers-9a525042.js";import"./redux-persist-d9cc1560.js";import"./redux-b7ba668d.js";import"./@reduxjs-4d37e7cf.js";import"./immer-41fd5235.js";import"./redux-thunk-ef899f4c.js";import"./axios-4a70c6fc.js";import"./react-router-dom-60901e53.js";import"./@remix-run-d753ad9e.js";import"./react-icons-55b3b9a0.js";const B={date:new Date,customer:"",from:null,to:null,otherField:"",field1:"",field2:"",field3:"",termsAndCond:"",ddChanger:500,ratePer:"",stations:[]},z={date:{invalid:!1,message:""},customer:{invalid:!1,message:""},from:{invalid:!1,message:""},to:{invalid:!1,message:""},ratePer:{invalid:!1,message:""},stations:{invalid:!1,message:""}},Ke=()=>{var q,h,H;const M=W(K),Q=ee(),{quotationId:P}=Q.state,[l,u]=f.useState(B),[r,N]=f.useState(z),[L,E]=f.useState(""),D=G(),T=te(),{places:p}=W(({quotation:t})=>t)||{},A=f.useCallback(()=>{T("/transactions/quotations")},[T]);f.useEffect(()=>{p!=null&&p.length&&P&&D(U(P)).then(({payload:t={}})=>{const{message:a}=(t==null?void 0:t.data)||{};a?E(a):u(t==null?void 0:t.data)}).catch(()=>{E("Something went wrong! Please try later or contact Administrator.")})},[p]);const R=()=>{A()},d=t=>{const a=t.target.name,i=t.target.value;u(m=>({...m,[a]:i}))},j=t=>{t.preventDefault(),O(l)||D($(l)).then(({payload:a={}})=>{const{message:i}=(a==null?void 0:a.data)||{};i?E(i):(E(""),N(z),u(B),A())}).catch(a=>{E(a.message)})},O=t=>{var m,o,g,S,Y;const a={...z};t.date||(a.date={invalid:!0,message:"Date is required"}),(o=(m=t.customer)==null?void 0:m.trim)!=null&&o.call(m)||(a.customer={invalid:!0,message:"Customer is required"}),t.from||(a.from={invalid:!0,message:"From date is required"}),t.to||(a.to={invalid:!0,message:"To date is required"}),(S=(g=t.ratePer)==null?void 0:g.trim)!=null&&S.call(g)||(a.ratePer={invalid:!0,message:"Rate type is required"}),(Y=t.stations)!=null&&Y.length||(a.stations={invalid:!0,message:"At least one entry is required"});let i=!1;for(const _ in a)a[_].invalid===!0&&(i=!0);return i&&N(a),i},C=(t,a)=>{u(i=>({...i,[t]:new Date(a)}))},V=(t,a)=>{var i,m;if(t.preventDefault(),(i=l.stations)!=null&&i.length){const o=l.stations;(m=o==null?void 0:o.splice)==null||m.call(o,a,1),u(g=>({...g,stations:o}))}};return e.createElement(e.Fragment,null,M&&e.createElement(X,null),e.createElement("h1",{className:"pageHead"},"Edit a quotation"),e.createElement("div",{className:"inner-wrap"},L!==""&&e.createElement(ae,{sx:{width:"100%",margin:"0 0 30px 0",border:"1px solid red",borderRadius:"4px"},spacing:2},e.createElement(re,{severity:"error"},L)),e.createElement(le,{sx:{padding:"20px",marginBottom:"20px"}},e.createElement("form",{action:"",onSubmit:j,id:"quotationForm"},e.createElement("div",{className:"grid grid-6-col"},e.createElement("div",{className:"grid-item"},e.createElement(n,{fullWidth:!0,error:r.date.invalid},e.createElement(b,{dateAdapter:x},e.createElement(F,{error:r.date.invalid,label:"Date",inputFormat:"DD/MM/YYYY",value:l.date,onChange:C.bind(null,"date"),renderInput:t=>e.createElement(s,{name:"date",size:"small",autoComplete:"off",...t,error:r.date.invalid})})),r.date.invalid&&e.createElement(v,null,r.date.message))),e.createElement("div",{className:"grid-item"},e.createElement(n,{fullWidth:!0,size:"small",error:r.customer.invalid},e.createElement(s,{size:"small",variant:"outlined",label:"Customer",value:l.customer,error:r.customer.invalid,onChange:d,name:"customer",id:"customer"}),r.customer.invalid&&e.createElement(v,null,r.customer.message))),e.createElement("div",{className:"grid-item"},e.createElement(n,{fullWidth:!0,error:r.from.invalid},e.createElement(b,{dateAdapter:x},e.createElement(F,{error:r.from.invalid,label:"From date",inputFormat:"DD/MM/YYYY",value:l.from,onChange:C.bind(null,"from"),renderInput:t=>e.createElement(s,{name:"from",size:"small",autoComplete:"off",...t,error:r.from.invalid})})),r.from.invalid&&e.createElement(v,null,r.from.message))),e.createElement("div",{className:"grid-item"},e.createElement(n,{fullWidth:!0,error:r.to.invalid},e.createElement(b,{dateAdapter:x},e.createElement(F,{error:r.to.invalid,label:"To date",inputFormat:"DD/MM/YYYY",value:l.to,onChange:C.bind(null,"to"),renderInput:t=>e.createElement(s,{name:"to",size:"small",autoComplete:"off",...t,error:r.to.invalid})})),r.to.invalid&&e.createElement(v,null,r.to.message))),e.createElement("div",{className:"grid-item"},e.createElement(n,{fullWidth:!0,size:"small",error:r.ratePer.invalid},e.createElement(s,{size:"small",variant:"outlined",label:"Rate per",helperText:"Ex. for 'Full Load' use short (F.L.)",FormHelperTextProps:{disabled:!0,classes:{sizeSmall:"small"}},value:l.ratePer,error:r.ratePer.invalid,onChange:d,name:"ratePer",id:"ratePer"}),r.ratePer.invalid&&e.createElement(v,null,r.ratePer.message))),e.createElement("div",{className:"grid-item"},e.createElement(n,{fullWidth:!0,size:"small"},e.createElement(s,{size:"small",variant:"outlined",label:"Other header field",value:l.otherField,onChange:d,name:"otherField",id:"otherField",helperText:"Ex. for 'Half Load' use short (H.L.)",FormHelperTextProps:{disabled:!0,classes:{sizeSmall:"small"}}})))," ",e.createElement("div",{className:"grid-item"},e.createElement(n,{fullWidth:!0,size:"small"},e.createElement(s,{size:"small",variant:"outlined",label:"Additional Terms and Condition",value:l.termsAndCond,onChange:d,name:"termsAndCond",id:"termsAndCond",inputProps:{maxLength:500}}))),e.createElement("div",{className:"grid-item"},e.createElement(n,{fullWidth:!0,size:"small"},e.createElement(s,{size:"small",variant:"outlined",label:"DD Changer",value:l.ddChanger||"",onChange:d,onInput:Z,name:"ddChanger",id:"ddChanger",InputProps:{startAdornment:e.createElement(ie,{position:"start"},"₹"),maxLength:10},inputProps:{maxLength:10}}))),e.createElement("div",{className:"grid-item"},e.createElement(n,{fullWidth:!0,size:"small"},e.createElement(s,{size:"small",variant:"outlined",label:"Field 1",value:l.field1,onChange:d,name:"field1",id:"field1",inputProps:{maxLength:20}}))),e.createElement("div",{className:"grid-item"},e.createElement(n,{fullWidth:!0,size:"small"},e.createElement(s,{size:"small",variant:"outlined",label:"Field 2",value:l.field2,onChange:d,name:"field2",id:"field2",inputProps:{maxLength:20}}))),e.createElement("div",{className:"grid-item"},e.createElement(n,{fullWidth:!0,size:"small"},e.createElement(s,{size:"small",variant:"outlined",label:"Field 3",value:l.field3,onChange:d,name:"field3",id:"field3",inputProps:{maxLength:20}}))))),e.createElement(I,{sx:{margin:"20px 0"}}),r.stations.invalid&&e.createElement("p",{className:"error"},r.stations.message),e.createElement(y,{places:p,quotation:l,setQuotation:u}),((q=l.stations)==null?void 0:q.length)>0?e.createElement(ne,null,e.createElement(se,{sx:{width:500},className:"tbl_jsm"},e.createElement(me,null,e.createElement(k,null,e.createElement(c,null,"Station"),e.createElement(c,{align:"right"},"Rate per ",l.ratePer),e.createElement(c,{align:"right"},l.otherField),e.createElement(c,{align:"right"}," "))),e.createElement(oe,null,(H=(h=l.stations)==null?void 0:h.map)==null?void 0:H.call(h,(t,a)=>e.createElement(k,{key:a,sx:{"&:last-child td, &:last-child th":{border:0}}},e.createElement(c,null,t.station),e.createElement(c,{align:"right"},"₹ ",t.amount),e.createElement(c,{align:"right"},"₹ ",t.otherFieldValue),e.createElement(c,null,e.createElement(de,{size:"small",onClick:i=>V(i,a),color:"error"},e.createElement(J,null)))))))):null,e.createElement(I,{sx:{margin:"20px 0"}}),e.createElement("div",{className:"right"},e.createElement(w,{variant:"outlined",size:"medium",onClick:R},"Back"),e.createElement(w,{variant:"contained",size:"medium",type:"submit",color:"primary",form:"quotationForm",className:"ml6"},"Save")))))};export{Ke as default};
