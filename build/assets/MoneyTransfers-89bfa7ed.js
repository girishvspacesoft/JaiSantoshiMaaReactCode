import{r as n,a as t}from"./react-69b9bddd.js";import{c as J,e as K,f as U}from"./icons-material-40f8e5d8.js";import"./Card.module-3bdbfb7f.js";import{C as X}from"./Dialog-c8953a08.js";import{cp as Y,cq as Z,L as V,k as y,cr as ee,a5 as te,cs as re,ct as se,cu as ae,ba as ne}from"./index-1d9d8716.js";import{u as S,a as oe}from"./react-redux-13959126.js";import{a as ie}from"./react-router-7dadf37a.js";import{u as ce,D as le,G as me}from"./x-data-grid-83fc2422.js";import{j as ue}from"./utils-49fe0532.js";import{i as de,A as fe,h as F,l as pe,O as ge,Q as he,m as Ee,f as I}from"./material-04052d9a.js";import"./@babel-5e587562.js";import"./react-dom-69e96a05.js";import"./scheduler-765c72db.js";import"./redux-persist-a379f351.js";import"./redux-fa075741.js";import"./@reduxjs-2459f64e.js";import"./immer-41fd5235.js";import"./redux-thunk-ef899f4c.js";import"./axios-21b846bc.js";import"./hoist-non-react-statics-1d21e5a8.js";import"./react-router-dom-38324838.js";import"./@remix-run-8989dd9f.js";import"./react-icons-6bc9af43.js";import"./use-sync-external-store-20ba4de3.js";import"./system-49be6911.js";import"./styled-engine-f8044af8.js";import"./@emotion-17579717.js";import"./stylis-79144faa.js";import"./private-theming-ec89146b.js";import"./react-transition-group-deabed87.js";import"./dom-helpers-9a525042.js";import"./base-e8cfb5a9.js";import"./@popperjs-f3391c26.js";import"./prop-types-b6d0a120.js";import"./reselect-36a88051.js";const ye=()=>{var h,D,E,M;const T=[{field:"_id",headerName:"Id"},{field:"pettyCashNo",headerName:"Petty cash no.",flex:1},{field:"transferToBranch",headerName:"Transfer to branch",flex:1},{field:"date",headerName:"Date",flex:1},{field:"amount",headerName:"Amount",flex:1,renderCell:e=>t.createElement("strong",null,"â‚¹ ",e.row.amount)},{field:"actions",headerName:"Action",flex:1,sortable:!1,renderCell:e=>{const r=a=>(a.stopPropagation(),j(e.row._id)),s=a=>(a.stopPropagation(),Q(e.row._id));return t.createElement(t.Fragment,null,t.createElement(I,{size:"small",onClick:s,color:"primary"},t.createElement(K,null)),y()?t.createElement(I,{size:"small",onClick:r,color:"error"},t.createElement(U,null)):null)}}],u=S(e=>e.user),B=S(Y),{search:p}=S(({moneytransfer:e})=>e),d=oe(),N=ie(),[i,O]=n.useState([]),[l,b]=n.useState(null),[f,P]=n.useState([]),[_,m]=n.useState(""),[k,g]=n.useState(!1),[L,z]=n.useState(""),[R,v]=n.useState(!1),x=ce();n.useEffect(()=>{d(Z()).then(({payload:e={}})=>{var s,a,o;const{message:r}=(e==null?void 0:e.data)||{};if(r)m(r);else if(m(""),O(e==null?void 0:e.data),(s=e==null?void 0:e.data)!=null&&s.length){const c=(o=(a=e==null?void 0:e.data)==null?void 0:a.filter)==null?void 0:o.call(a,C=>C._id===u.branch);c!=null&&c.length&&b(c[0])}}).catch(()=>{m("Something went wrong! Please try later or contact Administrator.")})},[]);const w=()=>{d(ee(l._id)).then(({payload:e={}})=>{var s,a;const{message:r}=(e==null?void 0:e.data)||{};r?m(r):P((a=(s=e==null?void 0:e.data)==null?void 0:s.map)==null?void 0:a.call(s,o=>{var c,C;return{...o,amount:(C=(c=o.amount)==null?void 0:c.toFixed)==null?void 0:C.call(c,2),date:te(new Date(o.date)),pettyCashNo:re(o.pettyCashNo),transferToBranch:H(o.transferToBranch)}}))}).catch(e=>{m(e.message)})};n.useEffect(()=>{l!=null&&l._id&&w()},[l]);const A=n.useMemo(()=>ue(e=>{var r,s,a;x.current.setQuickFilterValues((a=(s=(r=e.split)==null?void 0:r.call(e," "))==null?void 0:s.filter)==null?void 0:a.call(s,o=>o!==""))},500),[x]);n.useEffect(()=>{p&&(f!=null&&f.length)&&(v(!0),A(p),setTimeout(()=>{v(!1)},500))},[f]);const G=e=>{A(e.target.value),d(se(e.target.value))},H=e=>{var r;if(i!=null&&i.length){const s=(r=i==null?void 0:i.find)==null?void 0:r.call(i,a=>a._id===e);return s?s.name:e}return e},j=e=>{z(e),g(!0)},Q=e=>{N("/transactions/moneyTransfers/editMoneyTransfer",{state:{mtId:e}})},$=e=>{g(!0),e.target.value==="true"?d(ae(L)).then(({payload:r={}})=>{const{message:s}=(r==null?void 0:r.data)||{};s?m(s):(w(),g(!1))}).catch(r=>{m(r.message)}):g(!1)},q=(e,r)=>{b(r),d(ne(r._id))},W=()=>{N("/transactions/moneyTransfers/addMoneyTransfer",{state:l})};return t.createElement(t.Fragment,null,(B||R)&&t.createElement(V,null),t.createElement("div",{className:"inner-wrap"},k&&t.createElement(X,{isOpen:!0,onClose:$,title:"Are you sure?",content:"Do you want to delete the money transfer?",warning:!0}),t.createElement("div",{className:"page_head"},t.createElement("h1",{className:"pageHead"},"Money transfers"),t.createElement("div",{className:"page_actions"},t.createElement(de,{size:"small",sx:{width:"230px",marginRight:"5px"}},t.createElement(fe,{disablePortal:!0,size:"small",name:"branch",className:"multi-select",options:i,value:l||null,onChange:q,disabled:u&&u.type&&((D=(h=u.type)==null?void 0:h.toLowerCase)==null?void 0:D.call(h))!=="superadmin"&&((M=(E=u.type)==null?void 0:E.toLowerCase)==null?void 0:M.call(E))!=="admin",getOptionLabel:e=>e.name,openOnFocus:!0,renderInput:e=>t.createElement(F,{...e,label:"Select branch",fullWidth:!0})})),t.createElement(pe,{variant:"contained",size:"small",type:"button",color:"primary",className:"ml6",onClick:W},"Add a money transfer"))),_!==""&&t.createElement(ge,{sx:{width:"100%",margin:"0 0 30px 0",border:"1px solid red",borderRadius:"4px"},spacing:2},t.createElement(he,{severity:"error"},_)),t.createElement("div",{style:{width:"100%"}},t.createElement(le,{apiRef:x,sx:{backgroundColor:"primary.contrastText"},autoHeight:!0,density:"compact",getRowId:e=>e._id,rows:f,columns:T,initialState:{...T,columns:{columnVisibilityModel:{_id:!1}}},components:{Toolbar:()=>t.createElement(me,{sx:{gap:"6px",mb:"10px",justifyContent:"end",border:"none"}},t.createElement(F,{variant:"standard",placeholder:"Search...",autoFocus:!!p,onChange:G,value:p,style:{width:"300px"},InputProps:{startAdornment:t.createElement(Ee,{position:"start"},t.createElement(J,null))}}))},pageSize:10,rowsPerPageOptions:[10],disableSelectionOnClick:!0}))))};export{ye as default};
