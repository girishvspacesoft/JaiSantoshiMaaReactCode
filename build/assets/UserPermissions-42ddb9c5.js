import{r as o,a as e}from"./react-bfabd40c.js";import{a as K,u as N}from"./react-redux-45d870ba.js";import"./Card.module-3bdbfb7f.js";import{s as X,c as Y,f as Z,h as $,L as ee,u as te}from"./index-60b53c60.js";import{a as ne}from"./react-router-1b5f20a2.js";import{O as le,Q as re,a as x,i as F,A as T,h as O,D as ae,k as r,l as y}from"./material-e0a59a28.js";import"./@babel-e11bafe1.js";import"./react-dom-b0178e93.js";import"./scheduler-765c72db.js";import"./hoist-non-react-statics-6cfbf744.js";import"./use-sync-external-store-18921cc2.js";import"./redux-persist-d9cc1560.js";import"./redux-b7ba668d.js";import"./@reduxjs-4d37e7cf.js";import"./immer-41fd5235.js";import"./redux-thunk-ef899f4c.js";import"./axios-4a70c6fc.js";import"./react-router-dom-4405dfe9.js";import"./@remix-run-d753ad9e.js";import"./icons-material-4539f19e.js";import"./react-icons-55b3b9a0.js";import"./system-a1d29c52.js";import"./styled-engine-f3bd09bf.js";import"./@emotion-77835cc8.js";import"./stylis-79144faa.js";import"./utils-c03c978f.js";import"./private-theming-970ac73c.js";import"./react-transition-group-7ded6f4d.js";import"./dom-helpers-9a525042.js";import"./base-ff50cfe3.js";import"./@popperjs-f3391c26.js";const ce="_tbl_permissions_181m4_1",se="_head_181m4_7",p={tbl_permissions:ce,head:se},ze=()=>{const f=K(),A=N(t=>t.user),D=N(X),[z,C]=o.useState([]),[R,h]=o.useState(""),[i,H]=o.useState([]),[g,b]=o.useState(""),[E,V]=o.useState(""),[W,L]=o.useState({}),[n,w]=o.useState(null),[I,B]=o.useState(!1),v=ne();o.useEffect(()=>{var t;if(i!=null&&i.length){const c=(t=i==null?void 0:i.find)==null?void 0:t.call(i,s=>s._id===A.branch);c!=null&&c._id&&b(c)}},[i]),o.useEffect(()=>{if(n){let t=!0;for(const c in n)for(const s in n[c])if(n[c][s].write===!1){t=!1;break}B(t)}},[n]);const U=o.useCallback(()=>{v("/users/usersList")},[v]);o.useEffect(()=>{f(Y()).then(({payload:t={}})=>{const{message:c}=(t==null?void 0:t.data)||{};c?h(c):(H(t==null?void 0:t.data),h(""))}).catch(()=>{h("Something went wrong! Please try later or contact Administrator.")})},[]),o.useEffect(()=>{g&&f(Z(g==null?void 0:g._id)).then(({payload:t={}})=>{var s,m,u,d;const{message:c}=(t==null?void 0:t.data)||{};c?h(c):(h(""),((m=(s=A.type)==null?void 0:s.toLowerCase)==null?void 0:m.call(s))==="superadmin"?C(t==null?void 0:t.data):C((d=(u=t==null?void 0:t.data)==null?void 0:u.filter)==null?void 0:d.call(u,({id:_})=>A._id!==_)))}).catch(()=>{h("Something went wrong! Please try later or contact Administrator.")})},[g]),o.useEffect(()=>{E?f($(E==null?void 0:E.id)).then(({payload:t={}})=>{var c;L({...(t==null?void 0:t.data)||{}}),w((c=t==null?void 0:t.data)==null?void 0:c.permissions)}).catch(()=>{h("Something went wrong! Please try later or contact Administrator.")}):L({})},[E]);const Q=(t,c)=>{b(c),C([])},j=(t,c)=>{V(c)},a=(t,c)=>{var s,m,u;if(t.target.name==="Sales/Purchase_Add_FO_No_write"){const d="Sales/Purchase",_="Add_FO_No",k="write";w(P=>{const S={...P};return S[d][_][k]=c,S})}else{const d=t.target.name,_=(s=d.split)==null?void 0:s.call(d,"_")[0],k=(m=d.split)==null?void 0:m.call(d,"_")[1],P=(u=d.split)==null?void 0:u.call(d,"_")[2];w(S=>{const M={...S};return M[_][k][P]=c,M})}},q=t=>{t.preventDefault();const c={id:E==null?void 0:E.id,permissions:n};f(te(c)).then(({payload:s={}})=>{const{message:m}=(s==null?void 0:s.data)||{};m?h(m):(h(""),U())}).catch(()=>{h("Something went wrong! Please try later or contact Administrator.")})},G=()=>{U()},J=(t,c)=>{B(c),w(c?s=>{for(const m in s)for(const u in s[m])s[m][u].read=!0,s[m][u].write=!0;return s}:s=>{for(const m in s)for(const u in s[m])s[m][u].read=!1,s[m][u].write=!1;return s})},l=(E==null?void 0:E.type)==="User";return e.createElement(e.Fragment,null,D&&e.createElement(ee,null),e.createElement("h1",{className:"pageHead"},"User permissions"),e.createElement("div",{className:"inner-wrap"},R!==""&&e.createElement(le,{sx:{width:"100%",margin:"0 0 30px 0",border:"1px solid red",borderRadius:"4px"},spacing:2},e.createElement(re,{severity:"error"},R)),e.createElement("form",{className:"frm-bottom-spc",action:"",onSubmit:q},e.createElement(x,{sx:{padding:"20px",marginBottom:"20px"}},e.createElement("div",{className:"grid grid-6-col"},e.createElement("div",{className:"grid-item"},i&&(i==null?void 0:i.length)>0&&e.createElement(F,{fullWidth:!0,size:"small"},e.createElement(T,{disablePortal:!0,size:"small",name:"branch",options:i,value:g||null,onChange:Q,getOptionLabel:t=>t.name||"",openOnFocus:!0,renderInput:t=>e.createElement(O,{...t,label:"Branch",fullWidth:!0})}))),e.createElement("div",{className:"grid-item"},i&&(i==null?void 0:i.length)>0&&e.createElement(F,{fullWidth:!0,size:"small"},e.createElement(T,{disablePortal:!0,size:"small",name:"users",options:z,value:E||null,onChange:j,getOptionLabel:t=>t.username||"",openOnFocus:!0,renderInput:t=>e.createElement(O,{...t,label:"Users",fullWidth:!0})}))))),W.employee&&e.createElement(e.Fragment,null,e.createElement(ae,{sx:{marginBottom:"20px"}}),e.createElement(x,{sx:{padding:"20px",marginBottom:"20px",overflow:"auto"}},e.createElement("div",null,"Select All"," ",e.createElement(r,{name:"selectAll",checked:I,onChange:J})),e.createElement("table",{className:p.tbl_permissions},e.createElement("tbody",null,e.createElement("tr",null,e.createElement("td",{colSpan:10,className:p.head},"Master")),e.createElement("tr",null,e.createElement("td",{width:"10%"},"Branch"),e.createElement("td",{width:"10%"},e.createElement(r,{name:"Admin_Branch_write",disabled:l,checked:l?!1:n.Admin.Branch.write,onChange:a})),e.createElement("td",{width:"10%"},"Place"),e.createElement("td",{width:"10%"},e.createElement(r,{name:"Admin_Place_write",disabled:l,checked:l?!1:n.Admin.Place.write,onChange:a})),e.createElement("td",{width:"10%"},"Article"),e.createElement("td",{width:"10%"},e.createElement(r,{name:"Admin_Article_write",disabled:l,checked:l?!1:n.Admin.Article.write,onChange:a})),e.createElement("td",null,"Employee"),e.createElement("td",null,e.createElement(r,{name:"Admin_Employee_write",disabled:l,checked:l?!1:n.Admin.Employee.write,onChange:a})),e.createElement("td",null,"Driver"),e.createElement("td",null,e.createElement(r,{name:"Admin_Driver_write",disabled:l,checked:l?!1:n.Admin.Driver.write,onChange:a}))),e.createElement("tr",null,e.createElement("td",null,"Customers"),e.createElement("td",null,e.createElement(r,{name:"Admin_Customers_write",disabled:l,checked:l?!1:n.Admin.Customers.write,onChange:a})),e.createElement("td",null,"Supplier"),e.createElement("td",null,e.createElement(r,{name:"Admin_Supplier_write",disabled:l,checked:l?!1:n.Admin.Supplier.write,onChange:a})),e.createElement("td",null,"VehicleType"),e.createElement("td",null,e.createElement(r,{name:"Admin_VehicleType_write",disabled:l,checked:l?!1:n.Admin.VehicleType.write,onChange:a})),e.createElement("td",null,"Vehicle"),e.createElement("td",null,e.createElement(r,{name:"Admin_Vehicle_write",disabled:l,checked:l?!1:n.Admin.Vehicle.write,onChange:a})),e.createElement("td",null,"BankMaster"),e.createElement("td",null,e.createElement(r,{name:"Sales/Purchase_BankMaster_write",disabled:l,checked:l?!1:n["Sales/Purchase"].BankMaster.write,onChange:a}))),e.createElement("tr",null),e.createElement("tr",null,e.createElement("td",null,"BankAccountMaster"),e.createElement("td",null,e.createElement(r,{name:"Sales/Purchase_BankAccountMaster_write",disabled:l,checked:l?!1:n["Sales/Purchase"].BankAccountMaster.write,onChange:a})),e.createElement("td",null,"Rate Master (read)"),e.createElement("td",null,e.createElement(r,{name:"Admin_RateMaster_read",disabled:l,checked:l?!1:n.Admin.RateMaster.read,onChange:a})),e.createElement("td",null,"Rate Master"),e.createElement("td",null,e.createElement(r,{name:"Admin_RateMaster_write",disabled:l,checked:l?!1:n.Admin.RateMaster.write,onChange:a})),e.createElement("td",null),e.createElement("td",null),e.createElement("td",null),e.createElement("td",null)),e.createElement("tr",null,e.createElement("td",{colSpan:10,className:p.head},"Transactions")),e.createElement("tr",null,e.createElement("td",null,"LorryReceipt"),e.createElement("td",null,e.createElement(r,{name:"Sales/Purchase_LorryReceipt_write",checked:n["Sales/Purchase"].LorryReceipt.write,onChange:a})),e.createElement("td",null,"LorryReceiptReg"),e.createElement("td",null,e.createElement(r,{name:"Sales/Purchase_LorryReceiptReg_write",checked:n["Sales/Purchase"].LorryReceiptReg.write,onChange:a})),e.createElement("td",null,"Add_FO_No"),e.createElement("td",null,e.createElement(r,{name:"Sales/Purchase_Add_FO_No_write",checked:n["Sales/Purchase"].Add_FO_No.write,onChange:a})),e.createElement("td",null,"LorryFreightChallan"),e.createElement("td",null,e.createElement(r,{name:"Sales/Purchase_LoadingSlip_write",checked:n["Sales/Purchase"].LoadingSlip.write,onChange:a})),e.createElement("td",null,"LorryFreightChallanReg"),e.createElement("td",null,e.createElement(r,{name:"Sales/Purchase_LoadingSlipRegister_write",checked:n["Sales/Purchase"].LoadingSlipRegister.write,onChange:a}))),e.createElement("tr",null,e.createElement("td",null,"LRAcknowledge"),e.createElement("td",null,e.createElement(r,{name:"Sales/Purchase_LRAcknowledge_write",checked:n["Sales/Purchase"].LRAcknowledge.write,onChange:a})),e.createElement("td",null,"BillList"),e.createElement("td",null,e.createElement(r,{name:"Accounts_RouteBill_write",checked:n.Accounts.RouteBill.write,onChange:a})),e.createElement("td",null,"BillRegister"),e.createElement("td",null,e.createElement(r,{name:"Accounts_BillRegister_write",checked:n.Accounts.BillRegister.write,onChange:a})),e.createElement("td",null,"PaymentCollection"),e.createElement("td",null,e.createElement(r,{name:"Accounts_PaymentCollection_write",checked:n.Accounts.PaymentCollection.write,onChange:a})),e.createElement("td",null,"PaymentAdvice"),e.createElement("td",null,e.createElement(r,{name:"Sales/Purchase_PaymentAdvice_write",checked:n["Sales/Purchase"].PaymentAdvice.write,onChange:a}))),e.createElement("tr",null,e.createElement("td",{width:"10%"},"MoneyTransfer"),e.createElement("td",{width:"10%"},e.createElement(r,{name:"Admin_MoneyTransfer_write",checked:n.Admin.MoneyTransfer.write,onChange:a})),e.createElement("td",null,"Quotation"),e.createElement("td",null,e.createElement(r,{name:"Sales/Purchase_TripSheet_write",checked:n["Sales/Purchase"].TripSheet.write,onChange:a})),e.createElement("td",null),e.createElement("td",null),e.createElement("td",null),e.createElement("td",null),e.createElement("td",null),e.createElement("td",null)),e.createElement("tr",null,e.createElement("td",{colSpan:10,className:p.head},"Reports")),e.createElement("tr",null,e.createElement("td",null,"BilledLRStatus"),e.createElement("td",null,e.createElement(r,{name:"Accounts_BilledLRStatus_write",checked:n.Accounts.BilledLRStatus.write,onChange:a})),e.createElement("td",null,"LoadingTripsheet"),e.createElement("td",null,e.createElement(r,{name:"Accounts_LoadingSlip_write",checked:n.Accounts.LoadingSlip.write,onChange:a})),e.createElement("td",null),e.createElement("td",null),e.createElement("td",null),e.createElement("td",null),e.createElement("td",null),e.createElement("td",null)),e.createElement("tr",null,e.createElement("td",{colSpan:10,className:p.head},"User")),e.createElement("tr",null,e.createElement("td",null,"UserList"),e.createElement("td",null,e.createElement(r,{name:"User_UserActivation_write",disabled:l,checked:l?!1:n.User.UserActivation.write,onChange:a})),e.createElement("td",null,"RoleMaster"),e.createElement("td",null,e.createElement(r,{name:"User_RoleMaster_write",disabled:l,checked:l?!1:n.User.RoleMaster.write,onChange:a})),e.createElement("td",null,"ChangePassword"),e.createElement("td",null,e.createElement(r,{name:"User_ChangePassword_write",disabled:l,checked:l?!1:n.User.ChangePassword.write,onChange:a})),e.createElement("td",null,"UserRegister"),e.createElement("td",null,e.createElement(r,{name:"User_UserRegister_write",disabled:l,checked:l?!1:n.User.UserRegister.write,onChange:a})),e.createElement("td",null),e.createElement("td",null)))),e.createElement("div",{className:"right userpButtons"},e.createElement(y,{variant:"outlined",size:"medium",onClick:G},"Cancel"),e.createElement(y,{variant:"contained",size:"medium",type:"submit",color:"primary",className:"ml6"},"Save")))))))};export{ze as default};
