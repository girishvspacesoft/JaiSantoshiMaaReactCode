import{r as o,a as t}from"./react-ef3a9354.js";import{L as M,A as j,D as K}from"./x-date-pickers-488148bd.js";import"./Card.module-3bdbfb7f.js";import{by as Q,bG as V,L as J,bF as X,bE as R}from"./index-38e56929.js";import{u as Z,a as $}from"./react-redux-60e7b2bb.js";import{b as ee,a as te}from"./react-router-c905df87.js";import{O as re,Q as ae,a as ie,i as E,A as ne,h as N,V as y,l as D}from"./material-a209ad60.js";import"./@babel-5e587562.js";import"./@date-io-28dabb9c.js";import"./dayjs-39ab3f8d.js";import"./utils-7edb168f.js";import"./clsx-1229b3e0.js";import"./base-7d25deaf.js";import"./react-dom-7dcc36ef.js";import"./scheduler-765c72db.js";import"./@popperjs-f3391c26.js";import"./rifm-3b678e07.js";import"./system-5cdc79da.js";import"./styled-engine-b70b2ed8.js";import"./@emotion-afe87aa6.js";import"./hoist-non-react-statics-1d21e5a8.js";import"./stylis-79144faa.js";import"./private-theming-1cbad2aa.js";import"./react-transition-group-6e6f7170.js";import"./dom-helpers-9a525042.js";import"./redux-persist-cccb0614.js";import"./redux-fa075741.js";import"./@reduxjs-2459f64e.js";import"./immer-41fd5235.js";import"./redux-thunk-ef899f4c.js";import"./axios-21b846bc.js";import"./react-router-dom-584a1cea.js";import"./@remix-run-8989dd9f.js";import"./icons-material-e9adcbb1.js";import"./react-icons-5ea1dfbe.js";import"./use-sync-external-store-54e50305.js";const F={lrNo:null,deliveryDate:new Date},h={lrNo:{invalid:!1,message:""},deliveryDate:{invalid:!1,message:""}},Te=()=>{const z=Z(Q),{state:L}=ee(),[d,p]=o.useState(F),[u,H]=o.useState([]),[s,k]=o.useState(h),[b,m]=o.useState(""),[C,A]=o.useState(!0),[_,f]=o.useState(""),S=te(),v=$(),B=o.useRef(null),I=o.useCallback(()=>{S("/transactions/lrAcknowledgement")},[S]);o.useEffect(()=>{if(C){let r={};L&&(r={branch:L}),v(V(r)).then(({payload:e={}})=>{var i,n;const{message:a}=(e==null?void 0:e.data)||{};if(a)m(a);else{const c=(n=(i=e==null?void 0:e.data)==null?void 0:i.map)==null?void 0:n.call(i,l=>({...l,label:l.lrNo,value:l.lrNo}));H(c),A(!1)}}).catch(e=>{m(e.message)})}},[C]);const O=()=>{I()},W=r=>{if(r.preventDefault(),!q(d)){const e={_id:d.lrNo._id,deliveryDate:d.deliveryDate};v(X(e)).then(({payload:a={}})=>{const{message:i}=(a==null?void 0:a.data)||{};i?m(i):(m(""),k(h),p(F),f(""),A(!0))}).catch(a=>{m(a.message)})}},Y=(r,e)=>{var i;const a=(i=u==null?void 0:u.find)==null?void 0:i.call(u,({label:n})=>{var c,l,x,P,g,w;return((x=(l=(c=e==null?void 0:e.toLowerCase)==null?void 0:c.call(e))==null?void 0:l.trim)==null?void 0:x.call(l))===((w=(g=(P=n==null?void 0:n.toLowerCase)==null?void 0:P.call(n))==null?void 0:g.trim)==null?void 0:w.call(g))});a&&(d.isPrevented||(r.preventDefault(),r.stopPropagation()),p(n=>({...n,lrNo:a,isPrevented:!0})),a._id&&v(R(a._id)).then(({payload:n={}})=>{var c;f(((c=n==null?void 0:n.data)==null?void 0:c.lsNo)||"")}).catch(n=>{m(n.message)}))},q=r=>{const e={...h};r.deliveryDate||(e.deliveryDate={invalid:!0,message:"Delivery date is required"}),r.lrNo||(e.lrNo={invalid:!0,message:"LR no is required"});let a=!1;for(const i in e)e[i].invalid===!0&&(a=!0);return a&&k(e),a},T=(r,e)=>{p(a=>({...a,[r]:new Date(e)}))},U=r=>{p(e=>({...e,[r]:null}))},G=(r,e,a)=>{r.preventDefault(),p(i=>({...i,[a]:e})),e._id&&v(R(e._id)).then(({payload:i={}})=>{var n;f(((n=i==null?void 0:i.data)==null?void 0:n.lsNo)||"")}).catch(i=>{m(i.message)})};return t.createElement(t.Fragment,null,z&&t.createElement(J,null),t.createElement("div",{className:"inner-wrap"},t.createElement("h1",{className:"pageHead"},"Update a lorry receipt acknowledgement"),b!==""&&t.createElement(re,{sx:{width:"100%",margin:"0 0 30px 0",border:"1px solid red",borderRadius:"4px"},spacing:2},t.createElement(ae,{severity:"error"},b)),t.createElement("form",{action:"",onSubmit:W},t.createElement(ie,{sx:{padding:"20px",marginBottom:"20px"}},t.createElement("div",{className:"grid grid-6-col"},t.createElement("div",{className:"grid-item"},t.createElement(E,{fullWidth:!0,size:"small",error:s.lrNo.invalid},t.createElement(ne,{disablePortal:!0,size:"small",name:"lrNo",options:u,value:d.lrNo,onChange:(r,e)=>G(r,e,"lrNo"),ref:B,openOnFocus:!0,disableClearable:!0,renderInput:r=>t.createElement(N,{...r,inputProps:{...r.inputProps,onKeyDown:e=>{e.key==="Enter"&&(Y(e,e.target.value),e.stopPropagation())}},label:"Lorry receipt no",error:s.lrNo.invalid,fullWidth:!0})}),s.lrNo.invalid&&t.createElement(y,null,s.lrNo.message))),t.createElement("div",{className:"grid-item"},t.createElement(E,{fullWidth:!0},t.createElement(N,{size:"small",variant:"outlined",label:"Challan no.",value:_,name:"lsNo",id:"lsNo",inputProps:{readOnly:!0}}))),t.createElement("div",{className:"grid-item"},t.createElement("div",{className:"bl_date"},t.createElement(E,{fullWidth:!0,error:s.deliveryDate.invalid},t.createElement(M,{dateAdapter:j},t.createElement(K,{error:s.deliveryDate.invalid,label:"Delivery date",inputFormat:"DD/MM/YYYY",value:d.deliveryDate,onChange:T.bind(null,"deliveryDate"),inputProps:{readOnly:!0},renderInput:r=>t.createElement(N,{name:"deliveryDate",size:"small",...r,error:s.deliveryDate.invalid})})),s.deliveryDate.invalid&&t.createElement(y,null,s.deliveryDate.message)),t.createElement(D,{variant:"text",size:"medium",className:"clearHandler",onClick:U.bind(null,"deliveryDate")},"Clear")))),t.createElement("div",{className:"right"},t.createElement(D,{variant:"outlined",size:"medium",onClick:O},"Back"),t.createElement(D,{variant:"contained",size:"medium",type:"submit",color:"primary",className:"ml6"},"Save"))))))};export{Te as default};
