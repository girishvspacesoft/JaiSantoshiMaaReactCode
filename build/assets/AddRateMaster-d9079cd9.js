import{r as c,a}from"./react-bfabd40c.js";import{f as U}from"./icons-material-4539f19e.js";import"./Card.module-3bdbfb7f.js";import{aP as j,aS as J,aT as K,aU as X,L as Y,al as z,aV as Z}from"./index-54d20a5c.js";import{u as $,a as y}from"./react-redux-45d870ba.js";import{a as ee}from"./react-router-622b2d59.js";import{O as te,Q as ae,a as re,i as g,A as p,h as v,V as f,D as se,l as C,f as ie}from"./material-e0a59a28.js";import{D as ne}from"./x-data-grid-cceece3f.js";import"./@babel-e11bafe1.js";import"./react-dom-b0178e93.js";import"./scheduler-765c72db.js";import"./redux-persist-d9cc1560.js";import"./redux-b7ba668d.js";import"./@reduxjs-4d37e7cf.js";import"./immer-41fd5235.js";import"./redux-thunk-ef899f4c.js";import"./axios-4a70c6fc.js";import"./hoist-non-react-statics-6cfbf744.js";import"./react-router-dom-60901e53.js";import"./@remix-run-d753ad9e.js";import"./react-icons-55b3b9a0.js";import"./use-sync-external-store-18921cc2.js";import"./system-a1d29c52.js";import"./styled-engine-f3bd09bf.js";import"./@emotion-77835cc8.js";import"./stylis-79144faa.js";import"./utils-c03c978f.js";import"./private-theming-970ac73c.js";import"./react-transition-group-7ded6f4d.js";import"./dom-helpers-9a525042.js";import"./base-ff50cfe3.js";import"./@popperjs-f3391c26.js";import"./clsx-1229b3e0.js";import"./prop-types-d7fd566a.js";import"./reselect-36a88051.js";const N={customer:{invalid:!1,message:""},rates:{invalid:!1,message:""},rate:{invalid:!1,message:""},article:{invalid:!1,message:""},station:{invalid:!1,message:""}},Ve=()=>{var F;const b={customer:null,customerName:"",rates:[],article:"",station:null,rate:"",ddCharges:""},S=[{field:"_id",headerName:"Id"},{field:"article",headerName:"Article",flex:1},{field:"stationName",headerName:"Station",flex:1},{field:"rate",headerName:"Rate",flex:1},{field:"ddCharges",headerName:"DD charges",flex:1},{field:"actions",headerName:"Action",sortable:!1,flex:1,renderCell:e=>{const t=r=>(r.stopPropagation(),W(e.row._id));return a.createElement(a.Fragment,null,a.createElement(ie,{size:"small",onClick:t,color:"error"},a.createElement(U,null)))}}],[n,u]=c.useState(b),[I,_]=c.useState([]),[P,H]=c.useState([]),[d,M]=c.useState([]),[m,x]=c.useState(N),[A,o]=c.useState(""),R=$(j),L=ee(),h=y(),k=c.useCallback(()=>{L("/master/rateMasterList")},[L]),W=e=>{var r,s;const t=(s=(r=n.rates)==null?void 0:r.filter)==null?void 0:s.call(r,i=>i._id!==e);u(i=>({...i,rates:t}))};c.useEffect(()=>{h(J()).then(({payload:e={}})=>{var r,s;const{message:t}=(e==null?void 0:e.data)||{};if(t)o(t);else{o("");const i=(s=(r=e==null?void 0:e.data)==null?void 0:r.map)==null?void 0:s.call(r,l=>({...l,label:l.name,value:l.name}));H(i)}}).catch(e=>{o(e.message)}),h(K()).then(({payload:e={}})=>{var r,s;const{message:t}=(e==null?void 0:e.data)||{};if(t)o(t);else{o("");const i=(s=(r=e==null?void 0:e.data)==null?void 0:r.map)==null?void 0:s.call(r,l=>({...l,label:l.name,value:l.name}));M(i)}}).catch(e=>{o(e.message)}),h(X()).then(({payload:e={}})=>{var r,s;const{message:t}=(e==null?void 0:e.data)||{};if(t)o(t);else{o("");const i=(s=(r=e==null?void 0:e.data)==null?void 0:r.map)==null?void 0:s.call(r,l=>({...l,label:l.name,value:l.name}));_(i)}}).catch(e=>{o(e.message)})},[]);const D=e=>{const t=e.target.name,r=e.target.value;u(s=>({...s,[t]:r}))},B=e=>{var t,r;if(e.preventDefault(),!q(n)){const s=n;s.customer=s.customer._id,(r=(t=s.rates)==null?void 0:t.forEach)==null||r.call(t,i=>{i.station=i.station._id,delete i._id}),h(Z(s)).then(({payload:i={}})=>{const{message:l}=(i==null?void 0:i.data)||{};l?o(l):(o(""),u(b),k())}).catch(i=>{o(i.message)})}},O=()=>{k()},q=e=>{var s;const t={...N};e.customer||(t.customer={invalid:!0,message:"Customer is required"}),(s=e.rates)!=null&&s.length||(t.rates={invalid:!0,message:"At least one entry is required"});let r=!1;for(const i in t)t[i].invalid===!0&&(r=!0);return r&&x(t),r},T=(e,t,r)=>{u(s=>({...s,[r]:t,customerName:(t==null?void 0:t.name)||""}))},w=(e,t)=>{u(r=>({...r,article:t}))},V=(e,t,r)=>{u(s=>({...s,[r]:t}))},G=e=>{var s,i;e.preventDefault();const t={...N};n.customer?t.customer={invalid:!1,message:""}:t.customer={invalid:!0,message:"Customer is required"},n.article?t.article={invalid:!1,message:""}:t.article={invalid:!0,message:"Article is required"},n.station?t.station={invalid:!1,message:""}:t.station={invalid:!0,message:"Station is required"},!n.rate||n.rate<0?t.rate={invalid:!0,message:"Rate should be greater than 0"}:t.rate={invalid:!1,message:""};let r=!1;for(const l in t)t[l].invalid===!0&&(r=!0);if(r)x(t);else{const l={_id:Math.random(),article:n.article,station:n.station,stationName:n.station.name,rate:n.rate,ddCharges:n.ddCharges};(i=(s=n.rates)==null?void 0:s.some)!=null&&i.call(s,({station:E,article:Q})=>E===l.station&&Q===l.article)?o("Already item exist."):(u(E=>({...E,rates:[...E.rates,l],article:"",station:null,rate:"",ddCharges:""})),o(""))}};return a.createElement(a.Fragment,null,R&&a.createElement(Y,null),a.createElement("div",{className:"inner-wrap"},a.createElement("h1",{className:"pageHead"},"Add rate master"),A!==""&&a.createElement(te,{sx:{width:"100%",margin:"0 0 30px 0",border:"1px solid red",borderRadius:"4px"},spacing:2},a.createElement(ae,{severity:"error"},A)),!R&&a.createElement("div",null,a.createElement("form",{action:"",onSubmit:B},a.createElement(re,{sx:{padding:"20px",marginBottom:"20px"}},a.createElement("div",{className:"grid grid-6-col"},a.createElement("div",{className:"grid-item"},a.createElement(g,{fullWidth:!0,error:m.customer.invalid},a.createElement(p,{disablePortal:!0,autoSelect:!0,size:"small",name:"customer",options:I,value:n.customer,onChange:(e,t)=>T(e,t,"customer"),openOnFocus:!0,renderInput:e=>a.createElement(v,{...e,label:"Customer",error:m.customer.invalid,fullWidth:!0})}),m.customer.invalid&&a.createElement(f,null,m.customer.message)))),a.createElement(se,{className:"mb10"}),a.createElement("div",{className:"grid grid-6-col"},a.createElement("div",{className:"grid-item"},a.createElement(g,{fullWidth:!0,error:m.article.invalid},a.createElement(p,{autoSelect:!0,size:"small",name:"article",options:(F=d==null?void 0:d.map)==null?void 0:F.call(d,e=>e.name),value:n.article||null,onChange:(e,t)=>w(e,t),openOnFocus:!0,renderInput:e=>a.createElement(v,{...e,label:"Article",error:m.article.invalid,fullWidth:!0})}),m.article.invalid&&a.createElement(f,null,m.article.message))),a.createElement("div",{className:"grid-item"},a.createElement(g,{fullWidth:!0,error:m.station.invalid},a.createElement(p,{autoSelect:!0,size:"small",name:"place",options:P,value:n.station,onChange:(e,t)=>V(e,t,"station"),openOnFocus:!0,renderInput:e=>a.createElement(v,{...e,label:"Station",error:m.station.invalid,fullWidth:!0})}),m.station.invalid&&a.createElement(f,null,m.station.message))),a.createElement("div",{className:"grid-item"},a.createElement(g,{fullWidth:!0,error:m.rate.invalid},a.createElement(v,{size:"small",variant:"outlined",label:"Rate",value:n.rate||"",onChange:D,onInput:z,name:"rate",id:"rate",error:m.rate.invalid}),m.rate.invalid&&a.createElement(f,null,m.rate.message))),a.createElement("div",{className:"grid-item"},a.createElement(g,{fullWidth:!0},a.createElement(v,{size:"small",variant:"outlined",label:"DD charges",value:n.ddCharges||"",onChange:D,onInput:z,name:"ddCharges",id:"ddCharges"}))),a.createElement("div",{className:"grid-item"},a.createElement(C,{type:"button",variant:"outlined",size:"medium",onClick:G},"Add")))),a.createElement("div",{style:{width:"100%",marginBottom:"20px"}},m.rates.invalid&&a.createElement("div",null,a.createElement(f,{className:"error"},m.rates.message)),a.createElement(ne,{sx:{backgroundColor:"primary.contrastText"},autoHeight:!0,density:"compact",getRowId:e=>(e==null?void 0:e._id)||Math.random(),rows:n.rates,columns:S,initialState:{...S,columns:{columnVisibilityModel:{_id:!1}}},pageSize:10,rowsPerPageOptions:[10],disableSelectionOnClick:!0})),a.createElement("div",{className:"right"},a.createElement(C,{type:"button",variant:"outlined",size:"medium",onClick:O},"Back"),a.createElement(C,{variant:"contained",size:"medium",type:"submit",color:"primary",className:"ml6"},"Save"))))))};export{Ve as default};
