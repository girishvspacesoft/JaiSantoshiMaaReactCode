import{g as A}from"./@babel-5e587562.js";import{r as N}from"./react-69b9bddd.js";import{p as q}from"./prop-types-b6d0a120.js";var B={};(function(y){Object.defineProperty(y,"__esModule",{value:!0}),y.default=void 0;var D=_(N),i=_(q);function _(t){return t&&t.__esModule?t:{default:t}}function p(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?p=function(r){return typeof r}:p=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},p(t)}function O(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function P(t,n){for(var r=0;r<n.length;r++){var a=n[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function E(t,n,r){return n&&P(t.prototype,n),r&&P(t,r),t}function L(t){return function(){var n=d(t),r;if(I()){var a=d(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return R(this,r)}}function R(t,n){return n&&(p(n)==="object"||typeof n=="function")?n:h(t)}function h(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function I(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},d(t)}function W(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&v(t,n)}function v(t,n){return v=Object.setPrototypeOf||function(a,e){return a.__proto__=e,a},v(t,n)}function T(t,n,r){return n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function K(t){return typeof t.getAttribute!="function"?!1:!!t.getAttribute("contenteditable")}function k(t){if(!t)return!1;var n=t.tagName,r=K(t);return n==="INPUT"||n==="TEXTAREA"||r}function S(){try{return window.self!==window.top}catch{return!0}}var C=function(t){W(r,t);var n=L(r);function r(a){var e;return O(this,r),e=n.call(this,a),T(h(e),"initScannerDetection",function(){e.firstCharTime=0,e.stringWriting="",e.scanButtonCounter=0}),T(h(e),"scannerDetectionTest",function(o){var u=e.props,f=u.minLength,s=u.avgTimeByChar,c=u.onScanButtonLongPressed,b=u.scanButtonLongPressThreshold,m=u.onScan,g=u.onError;if(o&&(e.firstCharTime=0,e.lastCharTime=0,e.stringWriting=o),e.scanButtonCounter||(e.scanButtonCounter=1),e.stringWriting.length>=f&&e.lastCharTime-e.firstCharTime<e.stringWriting.length*s)return c&&e.scanButtonCounter>b?c(e.stringWriting,e.scanButtonCounter):m&&m(e.stringWriting,e.scanButtonCounter),e.initScannerDetection(),!0;var l="";return e.stringWriting.length<f?l="String length should be greater or equal ".concat(f):e.lastCharTime-e.firstCharTime>e.stringWriting.length*s&&(l="Average key character time should be less or equal ".concat(s,"ms")),g&&g(e.stringWriting,l),e.initScannerDetection(),!1}),T(h(e),"handleKeyPress",function(o){var u=e.props,f=u.onKeyDetect,s=u.onReceive,c=u.scanButtonKeyCode,b=u.stopPropagation,m=u.preventDefault,g=u.endChar,l=u.startChar,M=u.timeBeforeScanTest,w=o.target;w instanceof window.HTMLElement&&k(w)||(c&&o.which===c&&(e.scanButtonCounter+=1,o.preventDefault(),o.stopImmediatePropagation()),f&&f(o),b&&o.stopImmediatePropagation(),m&&o.preventDefault(),e.firstCharTime&&g.indexOf(o.which)!==-1?(o.preventDefault(),o.stopImmediatePropagation(),e.callIsScanner=!0):!e.firstCharTime&&l.indexOf(o.which)!==-1?(o.preventDefault(),o.stopImmediatePropagation(),e.callIsScanner=!1):(typeof o.which<"u"&&(e.stringWriting+=String.fromCharCode(o.which)),e.callIsScanner=!1),e.firstCharTime||(e.firstCharTime=Date.now()),e.lastCharTime=Date.now(),e.testTimer&&clearTimeout(e.testTimer),e.callIsScanner?(e.scannerDetectionTest(),e.testTimer=!1):e.testTimer=setTimeout(e.scannerDetectionTest,M),s&&s(o))}),e.firstCharTime=0,e.lastCharTime=0,e.stringWriting="",e.callIsScanner=!1,e.testTimer=!1,e.scanButtonCounter=0,e}return E(r,[{key:"componentDidMount",value:function(){S&&window.parent.document.addEventListener("keypress",this.handleKeyPress),window.document.addEventListener("keypress",this.handleKeyPress)}},{key:"componentWillUnmount",value:function(){S&&window.parent.document.removeEventListener("keypress",this.handleKeyPress),window.document.removeEventListener("keypress",this.handleKeyPress)}},{key:"render",value:function(){return this.props.testCode&&this.scannerDetectionTest(this.props.testCode),null}}]),r}(D.default.Component);C.propTypes={onScan:i.default.func,onError:i.default.func,onReceive:i.default.func,onKeyDetect:i.default.func,timeBeforeScanTest:i.default.number,avgTimeByChar:i.default.number,minLength:i.default.number,endChar:i.default.arrayOf(i.default.number),startChar:i.default.arrayOf(i.default.number),scanButtonKeyCode:i.default.number,scanButtonLongPressThreshold:i.default.number,onScanButtonLongPressed:i.default.func,stopPropagation:i.default.bool,preventDefault:i.default.bool,testCode:i.default.string},C.defaultProps={timeBeforeScanTest:100,avgTimeByChar:30,minLength:6,endChar:[9,13],startChar:[],scanButtonLongPressThreshold:3,stopPropagation:!1,preventDefault:!1};var x=C;y.default=x})(B);const z=A(B);export{z as B};
