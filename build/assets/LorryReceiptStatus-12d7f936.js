import{r as i,a as t}from"./react-69b9bddd.js";import{u as W,a as ie}from"./react-redux-13959126.js";import{h as oe}from"./icons-material-40f8e5d8.js";import{L as G,A as j,D as q}from"./x-date-pickers-f3802fc3.js";import{F as se}from"./file-saver-259f058c.js";import{c$ as me,d0 as ce,d1 as le,a5 as de,L as pe,k as ue,ba as ge,d2 as fe}from"./index-c349c545.js";import"./Card.module-3bdbfb7f.js";import{i as v,A as he,h as C,O as xe,Q as Ee,a as Q,a1 as be,a2 as z,l as F}from"./material-04052d9a.js";import{G as u}from"./@material-ui-d7516ac8.js";import{D as Se}from"./x-data-grid-83fc2422.js";import"./@babel-5e587562.js";import"./react-dom-69e96a05.js";import"./scheduler-765c72db.js";import"./hoist-non-react-statics-1d21e5a8.js";import"./use-sync-external-store-20ba4de3.js";import"./@date-io-28dabb9c.js";import"./dayjs-39ab3f8d.js";import"./utils-49fe0532.js";import"./clsx-1229b3e0.js";import"./base-e8cfb5a9.js";import"./@popperjs-f3391c26.js";import"./rifm-bf33b601.js";import"./system-49be6911.js";import"./styled-engine-f8044af8.js";import"./@emotion-17579717.js";import"./stylis-79144faa.js";import"./private-theming-ec89146b.js";import"./react-transition-group-deabed87.js";import"./dom-helpers-9a525042.js";import"./redux-persist-a379f351.js";import"./redux-fa075741.js";import"./@reduxjs-2459f64e.js";import"./immer-41fd5235.js";import"./redux-thunk-ef899f4c.js";import"./axios-21b846bc.js";import"./react-router-7dadf37a.js";import"./@remix-run-8989dd9f.js";import"./react-router-dom-38324838.js";import"./react-icons-6bc9af43.js";import"./jss-299ee23a.js";import"./is-in-browser-9e40da8a.js";import"./jss-plugin-rule-value-function-60587a41.js";import"./jss-plugin-global-c6030a8c.js";import"./jss-plugin-nested-fb36a984.js";import"./jss-plugin-camel-case-92f9f32c.js";import"./hyphenate-style-name-80972348.js";import"./jss-plugin-default-unit-2cb1c9e9.js";import"./jss-plugin-vendor-prefixer-24b01907.js";import"./css-vendor-1e7d08f8.js";import"./jss-plugin-props-sort-0c9fca2f.js";import"./prop-types-b6d0a120.js";import"./reselect-36a88051.js";const R={consignor:null,consignee:null,from:null,to:null,payType:"",searchText:""},bt=()=>{var O;const w=[{field:"_id",headerName:"Id"},{field:"srNo",headerName:"Sr No."},{field:"lrNo",headerName:"Consign No",flex:1},{field:"date",headerName:"Consign Date",flex:1},{field:"consignorName",headerName:"Consignor Name",flex:1},{field:"from",headerName:"From",flex:1},{field:"consigneeName",headerName:"Consignee Name",flex:1},{field:"to",headerName:"To",flex:1},{field:"payType",headerName:"Payment Mode",flex:1}],V=W(me),f=ie(),g=W(e=>e.user),[$,J]=i.useState([]),[B,c]=i.useState(""),[o,A]=i.useState(null),[r,h]=i.useState(R),[P,l]=i.useState(!1),[d,K]=i.useState({page:0,pageSize:100}),[x,U]=i.useState({isLoading:!1,data:[],total:0}),[X,L]=i.useState(!1);i.useEffect(()=>{f(ce()).then(({payload:e={}})=>{var a,s;const{message:n}=(e==null?void 0:e.data)||{};if(n)c(n);else if(c(""),J(e==null?void 0:e.data),g&&g.branch){const m=(s=(a=e==null?void 0:e.data)==null?void 0:a.find)==null?void 0:s.call(a,E=>E._id===g.branch);A(m)}}).catch(e=>{c(e.message)})},[]),i.useEffect(()=>{if(P&&(g.branch&&o||!g.branch)){L(!0);const e={};o&&o._id&&(e.branch=o._id),r.consignor&&r.consignor._id&&(e.consignor=r.consignor._id),r.consignee&&r.consignee._id&&(e.consignee=r.consignee._id),r.from&&(e.from=r.from),r.to&&(e.to=r.to),r.payType&&(e.payType=r.payType),r.searchText&&(e.searchText=r.searchText);const n={pagination:{limit:d.pageSize?d.pageSize:100,page:d.page+1},query:e};f(le(n)).then(({payload:a={}})=>{var m,E;L(!1);const{message:s}=(a==null?void 0:a.data)||{};if(s)c(s);else{const ae=(E=(m=a==null?void 0:a.data.lorryReceipts)==null?void 0:m.map)==null?void 0:E.call(m,(p,ne)=>{var b,k,S,y,T,H,N,Y;return{...p,srNo:ne+1,date:de(new Date(p.date)),totalWeight:(y=(S=(k=(b=p.transactions)==null?void 0:b.reduce)==null?void 0:k.call(b,(_,D)=>_+D.chargeWeight,0))==null?void 0:S.toFixed)==null?void 0:y.call(S,2),totalArticles:(Y=(N=(H=(T=p.transactions)==null?void 0:T.reduce)==null?void 0:H.call(T,(_,D)=>_+D.articleNo,0))==null?void 0:N.toFixed)==null?void 0:Y.call(N,2)}});U(p=>({...p,isLoading:!1,data:ae,total:a==null?void 0:a.data.count}))}l(!1)}).catch(a=>{l(!1),c(a.message),L(!1)})}},[d.page,d.pageSize,o,P]);const Z=(e,n)=>{A(n),l(!1),h(R),f(ge(n._id))},ee=e=>{e.preventDefault(),l(!0)},M=(e,n)=>{h(a=>({...a,[e]:new Date(n)}))},te=e=>{e.preventDefault(),h(R),l(!0)},re=e=>{e.preventDefault();const n={};o&&o._id&&(n.branch=o._id),r.consignor&&r.consignor._id&&(n.consignor=r.consignor._id),r.consignee&&r.consignee._id&&(n.consignee=r.consignee._id),r.from&&(n.from=r.from),r.to&&(n.to=r.to),r.payType&&(n.payType=r.payType),r.searchText&&(n.searchText=r.searchText),f(fe(n)).then(({payload:a={}})=>{const{message:s}=(a==null?void 0:a.data)||{};if(s)c(s);else{const m=new Blob([a==null?void 0:a.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});se.saveAs(m,"LoadedLorryReceipts.xlsx")}}).catch(a=>{c(a.message)})},I=(e,n="payType")=>{h(a=>({...a,[n]:e.target.value}))};return t.createElement(t.Fragment,null,(V||X)&&t.createElement(pe,null),t.createElement("div",{className:"inner-wrap"},t.createElement("div",{className:"page_head-1",style:{display:"flex",justifyContent:"space-between"}},t.createElement("h1",{className:"pageHead"},"Loaded Lorry Receipt Status"),t.createElement("div",{className:""},t.createElement(v,{size:"small",sx:{width:"230px",marginRight:"5px",marginBottom:"20px"}},t.createElement(he,{disablePortal:!0,size:"small",name:"branch",options:$,value:o||null,onChange:Z,disabled:!ue(),getOptionLabel:e=>e.name,openOnFocus:!0,renderInput:e=>t.createElement(C,{...e,label:"Select branch",fullWidth:!0})})))),B!==""&&t.createElement(xe,{sx:{width:"100%",margin:"0 0 30px 0",border:"1px solid red",borderRadius:"4px"},spacing:2},t.createElement(Ee,{severity:"error"},B)),t.createElement(Q,{sx:{padding:"20px",marginBottom:"20px"}},t.createElement("h2",{className:"mb20"},"Search"),t.createElement("form",{action:"",onSubmit:ee},t.createElement(u,{container:!0,spacing:3},t.createElement(u,{item:!0,xs:3},t.createElement(v,{fullWidth:!0},t.createElement(G,{dateAdapter:j},t.createElement(q,{label:"From",inputFormat:"DD/MM/YYYY",value:r.from,onChange:M.bind(null,"from"),renderInput:e=>t.createElement(C,{name:"from",size:"small",...e})})))),t.createElement(u,{item:!0,xs:3},t.createElement(v,{fullWidth:!0},t.createElement(G,{dateAdapter:j},t.createElement(q,{label:"To",inputFormat:"DD/MM/YYYY",value:r.to,onChange:M.bind(null,"to"),renderInput:e=>t.createElement(C,{name:"to",size:"small",...e})})))),t.createElement(u,{item:!0,xs:2},t.createElement(be,{color:"primary",value:r.payType,exclusive:!0,onChange:e=>I(e,"payType"),"aria-label":"Platform",size:"small"},t.createElement(z,{value:""},"All"),t.createElement(z,{value:"Open"},"Open"),t.createElement(z,{value:"Closed"},"Closed"))),t.createElement(u,{item:!0,xs:3},t.createElement(v,{fullWidth:!0},t.createElement(C,{size:"small",variant:"outlined",label:"Search in List By Consign No/Constomer Name",value:r.searchText,onChange:e=>I(e,"searchText"),name:"searchText",id:"searchText",inputProps:{maxLength:50}}))),t.createElement(u,{style:{display:"flex"},item:!0,xs:3},t.createElement(F,{type:"submit",variant:"contained",size:"medium",color:"primary"},"Search"),t.createElement(F,{type:"button",variant:"outlined",size:"medium",className:"ml6",onClick:e=>te(e)},"Reset"))))),t.createElement(Q,{sx:{width:"100%"}},((O=x.data)==null?void 0:O.length)>0?t.createElement("div",{className:"tbl_header"},t.createElement(F,{variant:"contained",endIcon:t.createElement(oe,null),onClick:re},"Export To Excel")):null,t.createElement(Se,{autoHeight:!0,density:"compact",rows:x.data,rowCount:x.total,loading:x.isLoading,pageSizeOptions:[100],paginationModel:d,onPaginationModelChange:e=>{K(e),l(!0)},paginationMode:"server",columns:w,getRowId:e=>e._id,sx:{backgroundColor:"primary.contrastText"},initialState:{...w,columns:{columnVisibilityModel:{_id:!1}}},disableSelectionOnClick:!0}))))};export{bt as default};
