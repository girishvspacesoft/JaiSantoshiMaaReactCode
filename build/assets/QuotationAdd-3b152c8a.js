import{r as C,a as e}from"./react-69b9bddd.js";import{u as I,a as ne}from"./react-redux-13959126.js";import{f as ie}from"./icons-material-40f8e5d8.js";import{L,A as N,D as A}from"./x-date-pickers-f3802fc3.js";import"./Card.module-3bdbfb7f.js";import{da as se,L as me,an as oe,di as de,dc as R}from"./index-1d9d8716.js";import{S as ce}from"./Stations-b566eaca.js";import{b as ue,a as ge}from"./react-router-7dadf37a.js";import{O as pe,Q as he,a as Ee,i as o,A as M,h as d,V as p,m as fe,D as O,a5 as ve,a6 as be,a7 as Ce,a8 as Q,a9 as s,aa as xe,f as ze,l as T}from"./material-04052d9a.js";import"./@babel-5e587562.js";import"./react-dom-69e96a05.js";import"./scheduler-765c72db.js";import"./hoist-non-react-statics-1d21e5a8.js";import"./use-sync-external-store-20ba4de3.js";import"./@date-io-28dabb9c.js";import"./dayjs-39ab3f8d.js";import"./utils-49fe0532.js";import"./clsx-1229b3e0.js";import"./base-e8cfb5a9.js";import"./@popperjs-f3391c26.js";import"./rifm-bf33b601.js";import"./system-49be6911.js";import"./styled-engine-f8044af8.js";import"./@emotion-17579717.js";import"./stylis-79144faa.js";import"./private-theming-ec89146b.js";import"./react-transition-group-deabed87.js";import"./dom-helpers-9a525042.js";import"./redux-persist-a379f351.js";import"./redux-fa075741.js";import"./@reduxjs-2459f64e.js";import"./immer-41fd5235.js";import"./redux-thunk-ef899f4c.js";import"./axios-21b846bc.js";import"./react-router-dom-38324838.js";import"./@remix-run-8989dd9f.js";import"./react-icons-6bc9af43.js";const D={date:new Date,customer:"",customerId:null,from:null,branch:null,to:null,otherField:"",field1:"",field2:"",field3:"",termsAndCond:"",ddChanger:500,ratePer:"",stations:[]},x={branch:{invalid:!1,message:""},date:{invalid:!1,message:""},customer:{invalid:!1,message:""},from:{invalid:!1,message:""},to:{invalid:!1,message:""},ratePer:{invalid:!1,message:""},stations:{invalid:!1,message:""}},it=()=>{var f,S,v,Y,k,b,y;const _=I(se),{state:j}=ue(),[r,c]=C.useState({...D,branch:j}),[l,z]=C.useState(x),[H,h]=C.useState(""),{places:V,branches:G,customers:J}=I(({quotation:t})=>t)||{},E=I(t=>t.user),W=ge(),F=ne(),q=C.useCallback(()=>{W("/transactions/quotations")},[W]),K=()=>{c(D),h(""),z(x)},U=()=>{q()},u=t=>{const a=t.target.name,n=t.target.value;c(i=>({...i,[a]:n}))},X=t=>{var a,n;t.preventDefault(),Z(r)||(r.branch&&(r.branch=(a=r.branch)==null?void 0:a._id),r.customerId&&(r.customerId=(n=r.customerId)==null?void 0:n._id),F(de(r)).then(({payload:i={}})=>{const{message:m}=(i==null?void 0:i.data)||{};m?h(m):(h(""),z(x),c(D),q())}).catch(i=>{h(i.message)}))},Z=t=>{var i,m,g,B,w;const a={...x};t.branch||(a.branch={invalid:!0,message:"Branch is required"}),t.date||(a.date={invalid:!0,message:"Date is required"}),(m=(i=t.customer)==null?void 0:i.trim)!=null&&m.call(i)||(a.customer={invalid:!0,message:"Customer is required"}),t.from||(a.from={invalid:!0,message:"From date is required"}),t.to||(a.to={invalid:!0,message:"To date is required"}),(B=(g=t.ratePer)==null?void 0:g.trim)!=null&&B.call(g)||(a.ratePer={invalid:!0,message:"Rate type is required"}),(w=t.stations)!=null&&w.length||(a.stations={invalid:!0,message:"At least one entry is required"});let n=!1;for(const le in a)a[le].invalid===!0&&(n=!0);return n&&z(a),n},P=(t,a)=>{c(n=>({...n,[t]:new Date(a)}))},$=(t,a,n)=>{c(i=>({...i,[n]:a}))},ee=(t,a)=>{a?typeof a=="object"&&c(n=>({...n,customerId:a,customer:a.label})):c(n=>({...n,customerId:null,customer:""}))},te=({target:t})=>{c(a=>({...a,customer:t.value,customerId:null})),ae(t.value)},ae=t=>{var n;const a=(n=t.trim)==null?void 0:n.call(t);(a==null?void 0:a.length)>2?F(R(a)):a||F(R())},re=(t,a)=>{var n,i;if(t.preventDefault(),(n=r.stations)!=null&&n.length){const m=r.stations;(i=m==null?void 0:m.splice)==null||i.call(m,a,1),c(g=>({...g,stations:m}))}};return e.createElement(e.Fragment,null,_&&e.createElement(me,null),e.createElement("h1",{className:"pageHead"},"Add a quotation"),e.createElement("div",{className:"inner-wrap"},H!==""&&e.createElement(pe,{sx:{width:"100%",margin:"0 0 30px 0",border:"1px solid red",borderRadius:"4px"},spacing:2},e.createElement(he,{severity:"error"},H)),e.createElement(Ee,{sx:{padding:"20px",marginBottom:"20px"}},e.createElement("form",{action:"",onSubmit:X,id:"quotationForm"},e.createElement("div",{className:"grid grid-6-col"},e.createElement("div",{className:"grid-item"},e.createElement(o,{fullWidth:!0,size:"small",error:l.branch.invalid},e.createElement(M,{disablePortal:!0,size:"small",name:"branch",options:G,value:r.branch,onChange:(t,a)=>$(t,a,"branch"),getOptionLabel:t=>t.name||"",openOnFocus:!0,disabled:E&&E.type&&((S=(f=E.type)==null?void 0:f.toLowerCase)==null?void 0:S.call(f))!=="superadmin"&&((Y=(v=E.type)==null?void 0:v.toLowerCase)==null?void 0:Y.call(v))!=="admin",renderInput:t=>e.createElement(d,{...t,label:"Branch",name:"branch",error:l.branch.invalid,fullWidth:!0})}),l.branch.invalid&&e.createElement(p,null,l.branch.message))),e.createElement("div",{className:"grid-item"},e.createElement(o,{fullWidth:!0,error:l.date.invalid},e.createElement(L,{dateAdapter:N},e.createElement(A,{error:l.date.invalid,label:"Date",inputFormat:"DD/MM/YYYY",value:r.date,onChange:P.bind(null,"date"),renderInput:t=>e.createElement(d,{name:"date",size:"small",autoComplete:"off",...t,error:l.date.invalid})})),l.date.invalid&&e.createElement(p,null,l.date.message))),e.createElement("div",{className:"grid-item"},e.createElement(o,{fullWidth:!0,size:"small",error:l.customer.invalid},e.createElement(M,{id:"customerId",autoSelect:!0,size:"small",name:"customerId",options:J,value:r.customerId,onChange:(t,a)=>ee(t,a),openOnFocus:!0,renderInput:t=>e.createElement(d,{...t,label:"Customer",name:"customerId",onChange:a=>te(a),error:l.customer.invalid,fullWidth:!0})}),l.customer.invalid&&e.createElement(p,null,l.customer.message))),e.createElement("div",{className:"grid-item"},e.createElement(o,{fullWidth:!0,error:l.from.invalid},e.createElement(L,{dateAdapter:N},e.createElement(A,{error:l.from.invalid,label:"From date",inputFormat:"DD/MM/YYYY",value:r.from,onChange:P.bind(null,"from"),renderInput:t=>e.createElement(d,{name:"from",size:"small",autoComplete:"off",...t,error:l.from.invalid})})),l.from.invalid&&e.createElement(p,null,l.from.message))),e.createElement("div",{className:"grid-item"},e.createElement(o,{fullWidth:!0,error:l.to.invalid},e.createElement(L,{dateAdapter:N},e.createElement(A,{error:l.to.invalid,label:"To date",inputFormat:"DD/MM/YYYY",value:r.to,onChange:P.bind(null,"to"),renderInput:t=>e.createElement(d,{name:"to",size:"small",autoComplete:"off",...t,error:l.to.invalid})})),l.to.invalid&&e.createElement(p,null,l.to.message))),e.createElement("div",{className:"grid-item"},e.createElement(o,{fullWidth:!0,size:"small",error:l.ratePer.invalid},e.createElement(d,{size:"small",variant:"outlined",label:"Rate per",helperText:"Ex. for 'Full Load' use short (F.L.)",FormHelperTextProps:{disabled:!0,classes:{sizeSmall:"small"}},value:r.ratePer,error:l.ratePer.invalid,onChange:u,name:"ratePer",id:"ratePer"}),l.ratePer.invalid&&e.createElement(p,null,l.ratePer.message))),e.createElement("div",{className:"grid-item"},e.createElement(o,{fullWidth:!0,size:"small"},e.createElement(d,{size:"small",variant:"outlined",label:"Other header field",helperText:"Ex. for 'Half Load' use short (H.L.)",FormHelperTextProps:{disabled:!0,classes:{sizeSmall:"small"}},value:r.otherField,onChange:u,name:"otherField",id:"otherField"}))),e.createElement("div",{className:"grid-item"},e.createElement(o,{fullWidth:!0,size:"small"},e.createElement(d,{size:"small",variant:"outlined",label:"Additional Terms and Condition",value:r.termsAndCond,onChange:u,name:"termsAndCond",id:"termsAndCond",inputProps:{maxLength:500}}))),e.createElement("div",{className:"grid-item"},e.createElement(o,{fullWidth:!0,size:"small"},e.createElement(d,{size:"small",variant:"outlined",label:"DD Changer",value:r.ddChanger||"",onChange:u,onInput:oe,name:"ddChanger",id:"ddChanger",InputProps:{startAdornment:e.createElement(fe,{position:"start"},"₹"),maxLength:10},inputProps:{maxLength:10}}))),e.createElement("div",{className:"grid-item"},e.createElement(o,{fullWidth:!0,size:"small"},e.createElement(d,{size:"small",variant:"outlined",label:"Field 1",value:r.field1,onChange:u,name:"field1",id:"field1",inputProps:{maxLength:20}}))),e.createElement("div",{className:"grid-item"},e.createElement(o,{fullWidth:!0,size:"small"},e.createElement(d,{size:"small",variant:"outlined",label:"Field 2",value:r.field2,onChange:u,name:"field2",id:"field2",inputProps:{maxLength:20}}))),e.createElement("div",{className:"grid-item"},e.createElement(o,{fullWidth:!0,size:"small"},e.createElement(d,{size:"small",variant:"outlined",label:"Field 3",value:r.field3,onChange:u,name:"field3",id:"field3",inputProps:{maxLength:20}}))))),e.createElement(O,{sx:{margin:"20px 0"}}),l.stations.invalid&&e.createElement("p",{className:"error"},l.stations.message),e.createElement(ce,{places:V,quotation:r,setQuotation:c}),((k=r.stations)==null?void 0:k.length)>0?e.createElement(ve,null,e.createElement(be,{sx:{width:"80%"},className:"tbl_jsm"},e.createElement(Ce,null,e.createElement(Q,null,e.createElement(s,null,"Station"),e.createElement(s,{align:"right"},"Rate per ",r.ratePer),e.createElement(s,{align:"right"},r.otherField),e.createElement(s,{align:"right"},r.field1),e.createElement(s,{align:"right"},r.field2),e.createElement(s,{align:"right"},r.field3),e.createElement(s,{align:"center"},"Action"))),e.createElement(xe,null,(y=(b=r.stations)==null?void 0:b.map)==null?void 0:y.call(b,(t,a)=>e.createElement(Q,{key:a,sx:{"&:last-child td, &:last-child th":{border:0}}},e.createElement(s,null,t.station),e.createElement(s,{align:"right"},"₹ ",t.amount),e.createElement(s,{align:"right"},"₹ ",t.otherFieldValue),e.createElement(s,{align:"right"},"₹ ",t.field1),e.createElement(s,{align:"right"},"₹ ",t.field2),e.createElement(s,{align:"right"},"₹ ",t.field3),e.createElement(s,{align:"center"},e.createElement(ze,{size:"small",onClick:n=>re(n,a),color:"error"},e.createElement(ie,null)))))))):null,e.createElement(O,{sx:{margin:"20px 0"}}),e.createElement("div",{className:"right"},e.createElement(T,{variant:"outlined",size:"medium",onClick:U},"Back"),e.createElement(T,{variant:"outlined",size:"medium",onClick:K,className:"ml6"},"Reset"),e.createElement(T,{variant:"contained",size:"medium",type:"submit",color:"primary",form:"quotationForm",className:"ml6"},"Save")))))};export{it as default};
