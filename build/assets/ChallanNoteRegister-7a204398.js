import{r as s,a as t}from"./react-bfabd40c.js";import{u as F,a as $}from"./react-redux-45d870ba.js";import{h as J}from"./icons-material-4539f19e.js";import{L as w,A,D as _}from"./x-date-pickers-7b1cc7dd.js";import{c$ as K,d0 as U,d1 as X,d2 as Z,L as y,b5 as ee,d3 as te}from"./index-66f971e4.js";import"./Card.module-3bdbfb7f.js";import{F as re}from"./file-saver-7e589f53.js";import{i as p,A as O,h as E,O as ne,Q as ie,a as I,l as x}from"./material-e0a59a28.js";import{G as u}from"./@material-ui-774e3213.js";import{D as ae}from"./x-data-grid-cceece3f.js";import"./@babel-e11bafe1.js";import"./react-dom-b0178e93.js";import"./scheduler-765c72db.js";import"./hoist-non-react-statics-6cfbf744.js";import"./use-sync-external-store-18921cc2.js";import"./@date-io-f382d426.js";import"./dayjs-7f45ce31.js";import"./utils-c03c978f.js";import"./clsx-1229b3e0.js";import"./base-ff50cfe3.js";import"./@popperjs-f3391c26.js";import"./rifm-7b0f12ad.js";import"./system-a1d29c52.js";import"./styled-engine-f3bd09bf.js";import"./@emotion-77835cc8.js";import"./stylis-79144faa.js";import"./private-theming-970ac73c.js";import"./react-transition-group-7ded6f4d.js";import"./dom-helpers-9a525042.js";import"./redux-persist-d9cc1560.js";import"./redux-b7ba668d.js";import"./@reduxjs-4d37e7cf.js";import"./immer-41fd5235.js";import"./redux-thunk-ef899f4c.js";import"./axios-4a70c6fc.js";import"./react-router-622b2d59.js";import"./@remix-run-d753ad9e.js";import"./react-router-dom-60901e53.js";import"./react-icons-55b3b9a0.js";import"./jss-7659e388.js";import"./is-in-browser-9e40da8a.js";import"./jss-plugin-rule-value-function-051edbeb.js";import"./jss-plugin-global-64559e95.js";import"./jss-plugin-nested-6377d8b0.js";import"./jss-plugin-camel-case-92f9f32c.js";import"./hyphenate-style-name-80972348.js";import"./jss-plugin-default-unit-593cc4c5.js";import"./jss-plugin-vendor-prefixer-4dd06b33.js";import"./css-vendor-33142dc8.js";import"./jss-plugin-props-sort-0c9fca2f.js";import"./prop-types-d7fd566a.js";import"./reselect-36a88051.js";const S={from:null,to:null,lrNo:"",consignor:null},it=()=>{var L;const C=[{field:"_id",headerName:"Id"},{field:"srNo",headerName:"Sr No.",minWidth:80,flex:1},{field:"formattedLSNo",headerName:"Challan No",flex:1,minWidth:80},{field:"generatedFrom",headerName:"Challan Generated From",flex:1,minWidth:100},{field:"date",headerName:"Date",minWidth:100,flex:1},{field:"vehicleNo",headerName:"Vehicle no",minWidth:100,flex:1},{field:"from",headerName:"From",minWidth:120,flex:1},{field:"to",headerName:"To",minWidth:120,flex:1},{field:"total",headerName:"Total Amount",minWidth:100,flex:1},{field:"lrNo",headerName:"LR No",minWidth:100,flex:1},{field:"consignorName",headerName:"Consignor",minWidth:150,flex:1},{field:"consigneeName",headerName:"Consignee",minWidth:150,flex:1},{field:"noOfArticle",headerName:"No. of Article",minWidth:90,flex:1},{field:"totalWeight",headerName:"Weight",minWidth:90,flex:1},{field:"payType",headerName:"Status",minWidth:90,flex:1}],P=F(K),h=$(),f=F(e=>e.user),[R,B]=s.useState([]),[H,M]=s.useState([]),[v,o]=s.useState(""),[m,W]=s.useState(null),[i,g]=s.useState(S),[z,c]=s.useState(!1),[l,Y]=s.useState({page:0,pageSize:100}),[N,k]=s.useState({isLoading:!1,data:[],total:0});s.useEffect(()=>{h(U()).then(({payload:e={}})=>{var n,a;const{message:r}=(e==null?void 0:e.data)||{};if(r)o(r);else if(o(""),B(e==null?void 0:e.data),f&&f.branch){const d=(a=(n=e==null?void 0:e.data)==null?void 0:n.find)==null?void 0:a.call(n,b=>b._id===f.branch);W(d)}}).catch(e=>{o(e.message)}),h(X()).then(({payload:e={}})=>{const{message:r}=(e==null?void 0:e.data)||{};r?o(r):(o(""),M(e==null?void 0:e.data))}).catch(e=>{o(e.message)})},[]),s.useEffect(()=>{if(z&&(f.branch&&m||!f.branch)){const e={};m&&m._id&&(e.branch=m._id),i.from&&(e.from=i.from),i.to&&(e.to=i.to),i.lrNo&&(e.lrNo=i.lrNo),i.consignor&&(e.consignor=i.consignor._id);const r={pagination:{limit:l.pageSize?l.pageSize:100,page:l.page+1},query:e};h(Z(r)).then(({payload:n={}})=>{const{message:a}=(n==null?void 0:n.data)||{};a?o(a):k(d=>({...d,isLoading:!1,data:(n==null?void 0:n.data.loadingSlips)||[],total:n==null?void 0:n.data.count})),c(!1)}).catch(n=>{c(!1),o(n.message)})}},[l.page,l.pageSize,m,z,h,i.from,i.lrNo,i.to]);const T=e=>{e.preventDefault();const r={isPrint:!0};m&&m._id&&(r.branch=m._id),i.from&&(r.from=i.from),i.to&&(r.to=i.to),i.lrNo&&(r.lrNo=i.lrNo),i.consignor&&(r.consignor=i.consignor._id);const n={pagination:{limit:l.pageSize?l.pageSize:100,page:l.page+1},query:r};h(te(n)).then(({payload:a={}})=>{const{message:d}=(a==null?void 0:a.data)||{};if(d)o(d);else{const b=new Blob([a==null?void 0:a.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});re.saveAs(b,"ChallanStatus.xlsx")}}).catch(a=>{o(a.message)})},j=(e,r,n)=>{g(a=>({...a,[n]:r}))},q=(e,r)=>{W(r),c(!1),g(S)},G=e=>{e.preventDefault(),c(!0)},D=(e,r)=>{g(n=>({...n,[e]:new Date(r)}))},V=e=>{e.preventDefault(),g(S),c(!0)},Q=e=>{const r=e.target.name,n=e.target.value;g(a=>({...a,[r]:n}))};return t.createElement(t.Fragment,null,P&&t.createElement(y,null),t.createElement("div",{className:"inner-wrap"},t.createElement("div",{className:"page_head-1",style:{display:"flex",justifyContent:"space-between"}},t.createElement("h1",{className:"pageHead"},"Challan Note Register"),t.createElement("div",{className:""},t.createElement(p,{size:"small",sx:{width:"230px",marginRight:"5px",marginBottom:"20px"}},t.createElement(O,{disablePortal:!0,size:"small",name:"branch",options:R,value:m||null,onChange:q,disabled:!ee(),getOptionLabel:e=>e.name,openOnFocus:!0,renderInput:e=>t.createElement(E,{...e,label:"Select branch",fullWidth:!0})})))),v!==""&&t.createElement(ne,{sx:{width:"100%",margin:"0 0 30px 0",border:"1px solid red",borderRadius:"4px"},spacing:2},t.createElement(ie,{severity:"error"},v)),t.createElement(I,{sx:{padding:"20px",marginBottom:"20px"}},t.createElement("h2",{className:"mb20"},"Search"),t.createElement("form",{action:"",onSubmit:G},t.createElement(u,{container:!0,spacing:3},t.createElement(u,{item:!0,xs:2},t.createElement(p,{fullWidth:!0},t.createElement(w,{dateAdapter:A},t.createElement(_,{label:"From",inputFormat:"DD/MM/YYYY",value:i.from,onChange:D.bind(null,"from"),renderInput:e=>t.createElement(E,{name:"from",size:"small",...e})})))),t.createElement(u,{item:!0,xs:2},t.createElement(p,{fullWidth:!0},t.createElement(w,{dateAdapter:A},t.createElement(_,{label:"To",inputFormat:"DD/MM/YYYY",value:i.to,onChange:D.bind(null,"to"),renderInput:e=>t.createElement(E,{name:"to",size:"small",...e})})))),t.createElement(u,{item:!0,xs:3},t.createElement(p,{fullWidth:!0,size:"small"},t.createElement(O,{disablePortal:!0,autoSelect:!0,autoHighlight:!0,size:"small",name:"consignor",options:H,value:i.consignor,onChange:(e,r)=>j(e,r,"consignor"),openOnFocus:!0,getOptionLabel:e=>e.name,renderInput:e=>t.createElement(E,{...e,label:"Customer",fullWidth:!0})}))),t.createElement(u,{item:!0,xs:2},t.createElement(p,{fullWidth:!0},t.createElement(E,{size:"small",variant:"outlined",label:"Lorry receipt no.",value:i.lrNo,onChange:Q,name:"lrNo",id:"lrNo",inputProps:{maxLength:50}}))),t.createElement(u,{style:{display:"flex"},item:!0,xs:2},t.createElement(x,{type:"submit",variant:"contained",size:"medium",color:"primary"},"Search"),t.createElement(x,{type:"button",variant:"outlined",size:"medium",className:"ml6",onClick:e=>V(e)},"Reset"))))),t.createElement(I,{sx:{width:"100%"}},((L=N.data)==null?void 0:L.length)>0?t.createElement("div",{className:"tbl_header"},t.createElement(x,{variant:"contained",endIcon:t.createElement(J,null),onClick:T},"Download")):null,t.createElement(ae,{autoHeight:!0,density:"compact",rows:N.data,rowCount:N.total,loading:N.isLoading,pageSizeOptions:[100],paginationModel:l,onPaginationModelChange:e=>{Y(e),c(!0)},paginationMode:"server",columns:C,getRowId:e=>e._id,sx:{backgroundColor:"primary.contrastText"},initialState:{...C,columns:{columnVisibilityModel:{_id:!1}}},disableSelectionOnClick:!0}))))};export{it as default};
